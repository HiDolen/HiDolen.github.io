<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计算机网络 | 时间·线</title><meta name="keywords" content="课堂笔记,考研,408"><meta name="author" content="HiDolen"><meta name="copyright" content="HiDolen"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="第1章 计算机网络体系结构  1.1 计算机网络概述 计算机网络的组成，  物理组成上，包括硬件、软件、协议  硬件：主机、通信处理机、通信线路、交换设备   工作方式上，分为边缘部分、核心部分  边缘部分：所有连接在互联网上、供用户直接使用的主机 核心部分：由大量的网络和连接这些网络的路由器组成，为边缘部分提供连通性和交换服务   功能组成上，由通信子网、资源子网构成  通信子网：各种传输介质">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络">
<meta property="og:url" content="http://example.com/[object%20Object]/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/index.html">
<meta property="og:site_name" content="时间·线">
<meta property="og:description" content="第1章 计算机网络体系结构  1.1 计算机网络概述 计算机网络的组成，  物理组成上，包括硬件、软件、协议  硬件：主机、通信处理机、通信线路、交换设备   工作方式上，分为边缘部分、核心部分  边缘部分：所有连接在互联网上、供用户直接使用的主机 核心部分：由大量的网络和连接这些网络的路由器组成，为边缘部分提供连通性和交换服务   功能组成上，由通信子网、资源子网构成  通信子网：各种传输介质">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7">
<meta property="article:published_time" content="2022-09-08T06:36:17.000Z">
<meta property="article:modified_time" content="2022-09-08T06:42:40.679Z">
<meta property="article:author" content="HiDolen">
<meta property="article:tag" content="课堂笔记">
<meta property="article:tag" content="考研">
<meta property="article:tag" content="408">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://example.com/[object%20Object]/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":false,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-08 14:42:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">110</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">时间·线</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-09-08T06:36:17.000Z" title="发表于 2022-09-08 14:36:17">2022-09-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-08T06:42:40.679Z" title="更新于 2022-09-08 14:42:40">2022-09-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/">课堂笔记</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/">考研</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/">408</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计算机网络"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="第1章-计算机网络体系结构"><a class="markdownIt-Anchor" href="#第1章-计算机网络体系结构"></a> 第1章 计算机网络体系结构</h2>
<h3 id="11-计算机网络概述"><a class="markdownIt-Anchor" href="#11-计算机网络概述"></a> 1.1 计算机网络概述</h3>
<p>计算机网络的组成，</p>
<ul>
<li>物理组成上，包括硬件、软件、协议
<ul>
<li>硬件：主机、通信处理机、通信线路、交换设备</li>
</ul>
</li>
<li>工作方式上，分为边缘部分、核心部分
<ul>
<li>边缘部分：所有连接在互联网上、供用户直接使用的主机</li>
<li>核心部分：由大量的网络和连接这些网络的路由器组成，为边缘部分提供连通性和交换服务</li>
</ul>
</li>
<li>功能组成上，由通信子网、资源子网构成
<ul>
<li>通信子网：各种传输介质、通信设备、响应的网络协议。为网络提供数据传输、交换和控制能力，实现联网计算机之间的数据通信
<ul>
<li>通信子网<strong>包括物理层、数据链路层、网络层</strong></li>
</ul>
</li>
<li>资源子网：主机、终端，各种软件资源、信息资源</li>
</ul>
</li>
</ul>
<p>计算机网络的功能，</p>
<ul>
<li>数据通信</li>
<li>资源共享</li>
<li>分布式处理</li>
<li>信息综合处理</li>
<li>负载均衡</li>
<li>提高可靠性</li>
</ul>
<p>计算机网络的分类，</p>
<ul>
<li>按分布范围分类
<ul>
<li>广域网（WAN），城域网（MAN），局域网（LAN），个人区域网（PAN）</li>
</ul>
</li>
<li>按传输技术分类
<ul>
<li>广播式网络，点对点网络</li>
</ul>
</li>
<li>按拓扑结构分类
<ul>
<li>总线形网络，星形网络（以单独线路与中央设备相连），环形网络，网状结构</li>
</ul>
</li>
<li>按使用者分类
<ul>
<li>公用网，专用网</li>
</ul>
</li>
<li>按交换技术分类
<ul>
<li><strong>电路交换网络</strong>，源结点和目的结点之间<em>建立一条专用的通路</em>
<ul>
<li>优点是数据直接传送、时延小，缺点是线路利用率低、不便于差错控制</li>
</ul>
</li>
<li><strong>报文交换网络</strong>，用户数据加上源地址、目的地址、校验码等，封装成报文，经结点转发</li>
<li><strong>分组交换网络</strong>，也称包交换网络，将数据分成较短的固定长度的数据块，每个数据块加上目的地址、源地址等信息组成分组（包）。<em>就是报文交换网络，但先进行数据切分</em></li>
</ul>
</li>
</ul>
<p>计算机网络的性能指标，</p>
<ul>
<li>带宽
<ul>
<li>在计算机网络中与<strong>传信率</strong>是同义词，单位为 b/s</li>
</ul>
</li>
<li>时延
<ul>
<li>发送时延，= 分组长度 / 信道宽度</li>
<li>传播时延，= 信道路程 / 传播速率，就是经典的路程除以速度</li>
<li>处理时延，排队时延（一般忽略不计）</li>
</ul>
</li>
<li>时延带宽积，发送的第一个比特即将到达时，发送端已经发出了多少个比特
<ul>
<li>就是链路中存有数据的最大值</li>
<li>= 传播时延 × 信道带宽</li>
</ul>
</li>
<li>往返时延，发送端发送，到发送端收到来自接收端的确认，总共经历的时延</li>
<li>吞吐量，单位时间内通过某个网络（或信道、接口）的数据量</li>
<li>速率。通常把最高数据传输速率称为带宽。b/s、bit/s、bps</li>
<li>信道利用率，也称 信道的效率，= 有数据通过的时间 / (有+无)数据通过的时间
<ul>
<li>= 发送时延 / 从发送到接受应答信号所需时间（往返时延）</li>
<li>做题时，往往会给出信道速率和传播时延
<ul>
<li>视 数据长度 / 信道速率，为 利用信道的时间</li>
<li>视 数据长度 / 信道速率 + 2 × 传播时延，为 总时间</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="12-计算机网络体系结构与参考模型"><a class="markdownIt-Anchor" href="#12-计算机网络体系结构与参考模型"></a> 1.2 计算机网络体系结构与参考模型</h3>
<p>体系结构，计算机网络的体系结构。通常具有可分层的特性。</p>
<ul>
<li>分层后的网络从底层到高层依次为第1层（物理层）、第2层……</li>
<li>第 n 层实体，第 n 层的活动元素。<strong>实体</strong>指任何可发送或接受信息的硬件或软件进程
<ul>
<li><strong>对等层</strong>，不同机器上的同一层</li>
<li>对等实体，同一层上的实体</li>
<li>服务提供者，第 n 层实体实现的服务为第 n+1 层所用</li>
</ul>
</li>
<li>每层的报文，分为两部分：数据部分（SDU）、控制信息部分（PCI），共同组成 PDU
<ul>
<li><strong>服务数据单元</strong>（SDU），为完成用户所要求的功能而应传送的数据
<ul>
<li>第 n 层的服务数据单元记为 n-SDU</li>
</ul>
</li>
<li>协议控制信息（PCI），控制协议操作的信息
<ul>
<li>第 n 层的协议控制信息记为 n-PCI</li>
</ul>
</li>
<li>协议数据单元（PDU），对等层之间传送的数据单元
<ul>
<li>第 n 层的协议数据单元记为 n-PDU</li>
<li>物理层 PDU 称为比特，数据链路层 PDU 称为帧，网络层称为分组，传输层称为报文段</li>
</ul>
</li>
<li>高层传输到低层，高层的 PDU 作为低层的 SDU，额外加上一个 PCI，就获得低层的 PDU
<ul>
<li><em>越底层数据越多</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>协议，</p>
<ul>
<li>网络协议，针对<strong>对等实体</strong>之间的协议。简称协议
<ul>
<li><em>协议是水平的</em>。例如，A 的传输层对 B 的网络层不存在协议，但两者的传输层存在协议</li>
<li>协议由三部分组成：
<ul>
<li>语法，规定传输数据的格式</li>
<li>语义，规定所要完成的功能，即要发出怎样的控制信息、做出怎样的应答</li>
<li>同步，规定了操作执行的条件、时序关系等</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>接口，</p>
<ul>
<li>网络体系结构中，相邻两层间交换信息的连接点</li>
</ul>
<p>服务，</p>
<ul>
<li>本层向上层提供的功能调用
<ul>
<li><em>服务是垂直的</em>。上层使用下层所提供的服务，需要命令</li>
<li>服务原语，命令在 OSI 参考模型中被称为服务原语。OSI 参考模型将原语划分为 4 类：
<ul>
<li>请求（Request），由服务的用户发送，请求完成某项工作</li>
<li>指示（Indication），由服务提供者发送，通知有事件发生</li>
<li>响应（Response），由服务的用户发送，响应刚才的指示</li>
<li>证实（Confirmation），由服务提供者发送，证实最开始的请求</li>
<li>无应答服务只有 请求、指示</li>
</ul>
</li>
</ul>
</li>
<li>提供的服务可分为：
<ul>
<li>面向连接服务、无连接服务。通信双方是否需要先建立连接，是否保证通信的可靠性</li>
<li>可靠服务、不可靠服务。网络是否具有纠错应答等机制，是否能保证数据正确、可靠地传输</li>
<li>有应答服务、无应答服务。接收方收到数据后是否发回应答消息</li>
</ul>
</li>
</ul>
<p><strong>接下来描述的各层顺序为逆顺序</strong>。例如，网络层 的下一层是 数据链路层（从用户到底层）。</p>
<h4 id="osi-参考模型-tcpip-模型"><a class="markdownIt-Anchor" href="#osi-参考模型-tcpip-模型"></a> OSI 参考模型、TCP/IP 模型</h4>
<p>OSI 参考模型（后面的知识点以 OSI 参考模型为准），</p>
<ul>
<li>开放系统互连参考模型，简称为 OSI 参考模型</li>
<li>各层：
<ul>
<li><strong>物理层</strong>，规定了电路接口的尺寸、电路数量等参数
<ul>
<li>以比特流形式传输。不需要进行数据封装</li>
<li>所要描述的接口特性：
<ul>
<li>机械特性，指明接口所用接线器的 形状尺寸、引脚数目和排列、固定和锁定装置等</li>
<li>电气特性，指明接口线缆的各个线的电压范围、传输距离</li>
<li>功能特性，指明各个线的不同电压代表的意义</li>
<li>过程特性 / 规程特性，指明功能的可能事件所出现的次序</li>
</ul>
</li>
<li>常用的物理层接口标准：EIA RS-232-C、ASDL、SONET/SDH</li>
</ul>
</li>
<li><strong>数据链路层</strong>，在不可靠的物理介质上提供可靠的传输，为网络层实体提供服务
<ul>
<li>拥有的功能：物理寻址、差错控制（校验与重发）、流量控制</li>
<li>传输单位是帧</li>
<li>服务访问点为 MAC 地址（网卡地址）</li>
<li>典型的数据链路层协议：SDLC、HDLC、PPP、STP、帧中继</li>
</ul>
</li>
<li><strong>网络层</strong> / IP 层，控制通信子网的运行，进行路由选择
<ul>
<li>传输单位是 数据报（IP 数据报），或称为 分组</li>
<li>实现了流量控制、拥塞控制、差错控制 等功能。关键问题是对分组进行路由选择
<ul>
<li>路由选择，两结点传输一个分组时，为其选出合适的路径</li>
<li>流量控制，协调两者的速率</li>
<li>差错控制，约定一个检错规则，对分组进行纠错或丢弃，保证上层得到的数据无误</li>
<li>拥塞控制，缓解互联网过于拥挤从而导致都无法通信的情况</li>
</ul>
</li>
<li>服务访问点是 IP 地址（网络地址）</li>
<li>常用的网络层协议：IP、IPX、ICMP、IGMP、ARP、RARP、OSPF</li>
</ul>
</li>
<li><strong>传输层</strong> / 运输层，负责进程间的通信，为端到端连接提供可靠传输服务
<ul>
<li>传输单位是 报文段 TCP 或 用户数据报 UDP</li>
<li>流量控制、差错控制等</li>
<li><strong>数据链路层是点到点（硬件地址、IP 地址），传输层是端到端（进程用端口进行通信）</strong></li>
<li>传输层服务向用户屏蔽了子网的变化</li>
<li>服务访问点是 端口号</li>
<li>传输层协议：TCP、UDP</li>
</ul>
</li>
<li>会话层，允许不同主机上的进程进行会话
<ul>
<li>会话，也称建立同步 SYN，为表示层实体建立连接，并在连接上有序地传输数据</li>
<li>会话层负责管理主机间的会话进程</li>
<li>会话层可使用校验点恢复通信，实现数据同步</li>
</ul>
</li>
<li>表示层，协调并转换机器间不同的编码与数据结构
<ul>
<li>可提供的数据表示变换功能，包括 数据压缩、加密、解密</li>
</ul>
</li>
<li><strong>应用层</strong>，是用户与网络的界面，是 OSI 参考模型的最高层
<ul>
<li>服务访问点是 用户界面</li>
<li>为某些网络应用提供应用协议。典型的有文件传输协议 FTP、超文本传输协议 HTTP</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>TCP/IP 模型，</p>
<table>
<thead>
<tr>
<th>TCP/IP 层</th>
<th>对应的 OSI 层</th>
</tr>
</thead>
<tbody>
<tr>
<td>网络接口层</td>
<td>物理层、数据链路层</td>
</tr>
<tr>
<td>网际层</td>
<td>网络层</td>
</tr>
<tr>
<td>传输层</td>
<td>传输层</td>
</tr>
<tr>
<td>应用层</td>
<td>（会话层、表示层）、应用层</td>
</tr>
</tbody>
</table>
<ul>
<li>网络接口层，指出网络类型，提供网络接口，帮助上层连接物理网络
<ul>
<li>主要是指出主机连接物理网络（以太网、令牌环网等）所使用的协议</li>
</ul>
</li>
<li>网际层 / 网络层，为分组寻找合适的路由并发送，但<strong>不保证分组的有序到达</strong>
<ul>
<li><strong>与 OSI 参考模型的重要区别：</strong>
<ul>
<li>TCP/IP 中，可靠性由端到端时处理，即网际层仅有一种无连接的通信方式</li>
<li>OSI 的 传输层 支持 无连接 和 面向连接 两种模式</li>
</ul>
</li>
<li>网际层定义了标准的分组格式和协议，即 IP</li>
</ul>
</li>
<li>传输层，也是负责端对端（进程）的通信
<ul>
<li>传输控制协议 TCP，报文段为传输单位，面向连接，提供可靠交付</li>
<li>用户数据报协议 UDP，数据报为传输单位，无连接，不保证可靠交付，只能 “尽可能交付”</li>
</ul>
</li>
<li>应用层，用户到用户的通信
<ul>
<li>包含所有高层协议：虚拟终端协议 Telnet、FTP、域名解析 DNS、超文本传输协议 HTTP 等</li>
</ul>
</li>
</ul>
<p>注意无连接（不可靠）、面向连接（可靠）：</p>
<ul>
<li>OSI 参考模型中，网络层 支持无连接、面向连接，传输层 仅支持面向连接；</li>
<li>TCP/IP 模型中，网络层 仅支持无连接，传输层 支持无连接、面向连接</li>
</ul>
<p>各层数据相关名词：数据部分 SDU，控制信息 PCI，二者共同组成 PDU（协议数据单元）。</p>
<h2 id="第2章-物理层"><a class="markdownIt-Anchor" href="#第2章-物理层"></a> 第2章 物理层</h2>
<p>注意，传输媒体不属于物理层，而是比物理层还要底层。</p>
<ul>
<li>这样想：传输媒体不知道自己传的是什么，但物理层规定了 0 和 1 分别怎样表示</li>
</ul>
<p>同步通信 效率高，但比 异步通信 的实现更麻烦。</p>
<h3 id="21-通信基础基础概念"><a class="markdownIt-Anchor" href="#21-通信基础基础概念"></a> 2.1 通信基础（基础概念）</h3>
<p>一些概念，</p>
<ul>
<li>数据，被传送信息的数据实体。分为模拟类型与数字类型</li>
<li>信号，数据的电气或电磁表现，是物理上的存在形式。分为模拟类型与数字类型</li>
<li>码元，一个固定时长的信号波形（数字脉冲），表示了一位 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 进制数字
<ul>
<li>码元宽度，该固定时长被称为码元宽度</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 进制码元。即一个码元可携带若干比特的信息量</li>
</ul>
</li>
<li>信源，通信中发送数据的源头</li>
<li>信宿，通信中接收数据的终点</li>
<li>信道，信号传播的媒介，通常包含一条发送信道和一条接收信道
<ul>
<li>噪声源由此干扰信号
<ul>
<li>噪声的分类：热噪声（导致随机差错）、冲击噪声（导致突发差错）</li>
</ul>
</li>
<li>信道上传送的信号分为：
<ul>
<li>基带信号，将数字信号直接用两种不同电压传输。多用于局域网</li>
<li>频带信号，传输被调制为的模拟信号。远距离传输、无线传输，且可多路复用</li>
<li>宽带信号，将基带信号调制为频分复用的模拟信号</li>
</ul>
</li>
<li>通信双方的三种交互方式：单向通信、半双工通信（不能同时收发）、全双工通信</li>
</ul>
</li>
<li>速率，也称数据率，指数据传输速率
<ul>
<li>码元传输速率（波特率），Baud/s</li>
<li>信息传输速率（信息速率、比特率），b/s，bit/s</li>
</ul>
</li>
<li>带宽，原指频带宽度（Hz），而网络中指数据传输速率，其实就是 b/s</li>
</ul>
<h4 id="奈奎斯特定理-香农定理"><a class="markdownIt-Anchor" href="#奈奎斯特定理-香农定理"></a> 奈奎斯特定理、香农定理</h4>
<p><strong>奈奎斯特定理</strong>，通过码元进制，计算无码间串扰的最大传输速率：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>2</mn><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mi>V</mi><mspace width="1em"/><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2W\log_2V\quad(b/s)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 是信道带宽，单位为 Hz</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi></mrow><annotation encoding="application/x-tex">V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span> 是不同码元的数量，即码元的进制数
<ul>
<li>所以，通过抬高码元进制数，奈奎斯特定理下的速率可达到无穷大</li>
</ul>
</li>
</ul>
<p><strong>香农定理</strong>，通过信噪比，计算信道的极限数据传输速率：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>W</mi><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>2</mn></msub><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo><mspace width="1em"/><mo stretchy="false">(</mo><mi>b</mi><mi mathvariant="normal">/</mi><mi>s</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">W\log_2(1+S/N)\quad(b/s)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathnormal">b</span><span class="mord">/</span><span class="mord mathnormal">s</span><span class="mclose">)</span></span></span></span></span></p>
<ul>
<li>信噪比 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>10</mn><msub><mo><mi>log</mi><mo>⁡</mo></mo><mn>10</mn></msub><mo stretchy="false">(</mo><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">10\log_{10}(S/N)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.20696799999999996em;"><span style="top:-2.4558600000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24414em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mclose">)</span></span></span></span>
<ul>
<li>例如信噪比为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>30</mn><mrow><mi mathvariant="normal">d</mi><mi mathvariant="normal">B</mi></mrow></mrow><annotation encoding="application/x-tex">30\mathrm{dB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord"><span class="mord mathrm">d</span><span class="mord mathrm">B</span></span></span></span></span> 时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi mathvariant="normal">/</mi><mi>N</mi><mo>=</mo><mn>1000</mn></mrow><annotation encoding="application/x-tex">S/N=1000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></li>
<li>信噪比越高，通信效果越好</li>
</ul>
</li>
<li>这样想：香农 表明 奈奎斯特 中的码元进制数是有限的</li>
</ul>
<h4 id="编码-调制"><a class="markdownIt-Anchor" href="#编码-调制"></a> 编码、调制</h4>
<p><strong>调制</strong>，数据变为模拟信号。</p>
<p><strong>编码</strong>，数据变为数字信号。</p>
<p>数字数据 编码为 数字信号，常用编码：</p>
<ul>
<li>归零编码 RZ，时钟周期开始时用 高电平、低电平 表示 1、0，且周期内某时机跳回低电平
<ul>
<li>接收方根据归零跳变调整时钟，这为传输双方提供了自同步机制</li>
<li>归零要占用一部分带宽，影响传输效率</li>
</ul>
</li>
<li>非归零编码 NRZ，相比于 RZ 不用归零，仅在时钟周期开始时可能跳变
<ul>
<li>无法传递时钟信号。若要传输高速同步数据，需要额外的时钟线</li>
</ul>
</li>
<li>反向归零编码 NRZI，用信号翻转代表 0、保持不变代表 1
<ul>
<li>怪异的是它能传输时钟信号，且不会因归零而占用带宽</li>
</ul>
</li>
<li>曼彻斯特编码，将一个周期分成两个等间隔部分，先低后高代表 0、先高后低代表 1
<ul>
<li>用 “01” 两位码表示 “0”，用 “10” 两位码表示 “1”</li>
<li>位于周期中间的跳变可同时作为 时钟信号 和 数据信号。但占用了两倍的频带宽度</li>
<li><strong>常用于以太网</strong></li>
</ul>
</li>
<li>差分曼彻斯特码，同样是码元中心发生跳变，但规则如下：
<ul>
<li>若码元为 1，本周期前半部分 与 上周期后半部分 电平相同；</li>
<li>若码元为 0，本周期前半部分 与 上周期后半部分 电平相反；</li>
<li>抗干扰性好</li>
</ul>
</li>
<li>4B/5B 编码，数据流以 4 位为一组，按照 4B/5B 编码规则转换成 5 位码
<ul>
<li>使用 5 位码中的 16 种编码对应 4 位码，其余 16 种编码作为控制码或保留</li>
<li><strong>常用于千兆以太网</strong></li>
</ul>
</li>
</ul>
<p>数字数据 调制为 模拟信号，常用调制方法：</p>
<ul>
<li>幅移键控 ASK，又称振幅键控，对一个频率和相位恒定不变的载波，进行幅度上的键控
<ul>
<li>有幅度时为 1，振幅为零时为 0</li>
<li>容易实现，抗干扰能力差</li>
</ul>
</li>
<li>频移键控 FSK，通过改变载波信号的频率表示数字信号，即进行频率上的键控
<ul>
<li>规定两种固定的频率分别为 1、0</li>
<li>容易实现，抗干扰能力强，应用广泛</li>
</ul>
</li>
<li>相移键控 PSK，通过改变载波信号的相位表示数字信号，即进行相位上的键控
<ul>
<li>通常用初始相位 0 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi></mrow><annotation encoding="application/x-tex">π</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span></span> 分别表示 1、0</li>
<li>又分为 绝对调相 和 相对调相（用前后相位差值表示 1、0）</li>
</ul>
</li>
<li>正交振幅调制 QAM，将两个相位时刻变化、频率相同的载波叠加
<ul>
<li>采样 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 个相位获得对应振幅，每个相位的振幅有 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 种大小，则每次可传输 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">mn</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">n</span></span></span></span> 种数码</li>
</ul>
</li>
</ul>
<p>模拟数据 编码为 数字信号，</p>
<ul>
<li>主要步骤：采样、量化、编码
<ul>
<li>采样频率 为原始信号最大频率的 2 倍（奈奎斯特定理）时，可无失真地表示原始信号</li>
</ul>
</li>
</ul>
<p>模拟数据 调制为 模拟信号，为了充分利用带宽将原信号调制到更高频率的信号（频分复用）。</p>
<h4 id="电路交换-报文交换-分组交换"><a class="markdownIt-Anchor" href="#电路交换-报文交换-分组交换"></a> 电路交换、报文交换、分组交换</h4>
<p>电路交换，使用专用物理线路进行通信。</p>
<ul>
<li>特点：
<ul>
<li>独占一条物理通信路径，可能途径多个结点。直到通信结束再释放</li>
<li>路径上任何结点都采用直通方式收发数据，不存在存储转发花费额外时间</li>
</ul>
</li>
<li>优点：通信时延小、有序传输、没有冲突、可模拟信号也可数字信号、实时性强、控制简单</li>
<li>缺点：建立连接时间长、独占线路、灵活性差（抗干扰差）、不能检错</li>
</ul>
<p>报文交换，以报文为单位，在结点采用 存储转发 进行传输。</p>
<ul>
<li>特点：
<ul>
<li>报文携有 目标地址、源地址 等额外信息</li>
</ul>
</li>
<li>优点：
<ul>
<li>无需建立连接（无连接时延）、线路利用率高，通信双方不需要建立专用通信线路</li>
<li>可动态分配线路、线路可靠性高。收到报文的交换设备会选择合适的空闲线路</li>
<li>一个报文可发给多个目标</li>
</ul>
</li>
<li>缺点：有转发时延（传输时延）、需要网络结点拥有较大缓存空间</li>
</ul>
<p>分组交换，以 分组 的方式限制数据块的大小，在结点采用 存储转发 进行传输。</p>
<ul>
<li>特点：
<ul>
<li>更为先进。现代多用分组交换</li>
<li>大的数据块会被划分，并增加必要的控制信息，以构成分组</li>
</ul>
</li>
<li>优点：
<ul>
<li>无需建立连接（无连接时延）、线路利用率高，用公共的通信线路进行通信</li>
<li>分组的长度固定，便于并行传输，减少了传输时延</li>
<li>减少出错概率，减少重发次数，提高可靠性</li>
</ul>
</li>
<li>缺点：有转发时延（传输时延）、附加的控制信息降低了传输效率、差错控制更为复杂</li>
</ul>
<h4 id="分组交换的数据报-虚电路"><a class="markdownIt-Anchor" href="#分组交换的数据报-虚电路"></a> 分组交换的：数据报、虚电路</h4>
<p>对于分组交换，分为 数据报（无连接）、虚电路（面向连接）。</p>
<p><strong>数据报</strong>，在网络层形成分组，寻找路由并发送。</p>
<ul>
<li>特点：
<ul>
<li>发送分组前不需要建立连接，但每个分组须携带源地址、目标地址</li>
<li>传输不保证可靠性，可能丢失；分组因路由不同而可能不按顺序到达</li>
<li>分组采用存储转发，会产生延时</li>
<li>对故障适应性强，可动态调制转发路径</li>
</ul>
</li>
</ul>
<p><strong>虚电路</strong>，在分组发送前建立一条逻辑上的虚拟专线。</p>
<ul>
<li>网络中的每个结点都维护一张 虚电路表，记录所有打开的 虚电路</li>
<li>要进行传输，发送方发送 呼叫请求，接收方发回 呼叫应答，以建立虚电路
<ul>
<li>虚电路建立后即可双向通信，分组仅须携带虚电路号</li>
<li>要断开虚电路，通过发送 释放请求 与发回 释放应答，逐段断开连接</li>
</ul>
</li>
<li>特点：
<ul>
<li>虚电路的建立与拆除需要时间开销</li>
<li>提供了可靠的通信功能，可保证传输的分组顺序，还能做到流量控制</li>
<li>路由选择在连接建立阶段被确定，不如数据报灵活、比数据报迅速
<ul>
<li>若某结点或某链路失效，会导致途径此处的虚电路被破坏</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>数据报服务</th>
<th>虚电路服务</th>
</tr>
</thead>
<tbody>
<tr>
<td>建立连接</td>
<td>不需要</td>
<td>必须</td>
</tr>
<tr>
<td>目的地址</td>
<td>每个分组含有完整目的地址</td>
<td>建立连接后，分组仅需包含虚电路号</td>
</tr>
<tr>
<td>路由选择</td>
<td>每个分组独立进行路由选择</td>
<td>同一条虚电路上的分组按固定路由转发</td>
</tr>
<tr>
<td>可靠性</td>
<td>由用户主机保证可靠性</td>
<td>由网络本身保证可靠性</td>
</tr>
<tr>
<td>故障适应性</td>
<td>强，可动态调制路由</td>
<td>弱</td>
</tr>
<tr>
<td>功能</td>
<td>少</td>
<td>可替主机负责 差错处理、流量控制</td>
</tr>
</tbody>
</table>
<h3 id="22-传输介质"><a class="markdownIt-Anchor" href="#22-传输介质"></a> 2.2 传输介质</h3>
<p>传输介质，又称 传输媒体，是物理通路。</p>
<p><strong>双绞线</strong>，最常用的古老传输介质，使用两根相互绝缘的铜线绞合而成。</p>
<ul>
<li>根据是否有金属丝编织成的屏蔽层包裹，可分为：屏蔽双绞线 STP、非屏蔽双绞线 UTP</li>
<li>价格便宜，多用于局域网、座机电话</li>
<li>通信距离通常在数千米，再远就需要 放大器 的放大（模拟）或 中继器 的整形（数字）</li>
</ul>
<p><strong>同轴电缆</strong>，各层包裹的结构，抗干扰性好。</p>
<ul>
<li>由内而外依次为：内导体、绝缘层、外导体屏蔽层、绝缘保护套层（就是塑料）</li>
<li>半双工</li>
<li>传输距离更远，但更贵</li>
</ul>
<p><strong>光纤</strong>，光导纤维。可见光频率为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><msup><mn>0</mn><mn>8</mn></msup><mrow><mi mathvariant="normal">M</mi><mi mathvariant="normal">H</mi><mi mathvariant="normal">z</mi></mrow></mrow><annotation encoding="application/x-tex">10^8\mathrm{MHz}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord"><span class="mord">0</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathrm">M</span><span class="mord mathrm">H</span><span class="mord mathrm">z</span></span></span></span></span>，带宽范围极大。</p>
<ul>
<li>纤芯仅有 8 ~ 100 μm</li>
<li>纤芯 高折射率，包层 低折射率，光纤不断全反射</li>
<li>多模光纤，从不同角度入射的多条光纤同时在一根光纤中传输。适于近距离传输</li>
<li>单模光纤，光纤直径只有光的一个波长，光纤会直线向前传播
<ul>
<li>直径几μm，衰减小，成本高，适于远距离传输</li>
</ul>
</li>
</ul>
<p><strong>无线传输介质</strong>，如下分类，</p>
<ul>
<li>无线电波，广泛用于通信领域（无线局域网、手机通信）
<ul>
<li>穿透能力强，有效距离内无需对准方向</li>
</ul>
</li>
<li>微波、红外线、激光，高带宽的无线通信
<ul>
<li>有很强的方向性，通信双方存在一条视线，所以又称三者为视线介质</li>
<li>微波用于卫星通信</li>
</ul>
</li>
</ul>
<h3 id="23-物理层设备中继器-集线器"><a class="markdownIt-Anchor" href="#23-物理层设备中继器-集线器"></a> 2.3 物理层设备（中继器、集线器）</h3>
<p><strong>中继器</strong>，也称转发器，将信号整形再生，以消除信号的失真和衰减。工作于物理层。</p>
<ul>
<li>如果一个网络设备具有存储转发功能，那么可以认为它能连接两个不同的协议
<ul>
<li>所以，中继器不能连接两个速率不同的网段，两段一定要用同一个协议</li>
</ul>
</li>
<li>中继器的使用通常有数量上限，不能无限制中继
<ul>
<li>5 - 4 - 3 规则：5 个网段、4 个中继器、3 个网段为主机段</li>
</ul>
</li>
<li>相比于放大器：中继器 用于数字信号，放大器 用于模拟信号</li>
</ul>
<p><strong>集线器</strong> Hub，实质上是 多端口的中继器。</p>
<ul>
<li>同时仅允许一端输入，限制了网络吞吐量
<ul>
<li>只能半双工通信。用分时的方式共享一个 Hub</li>
<li>意味着所有集线器端口共属于一个 冲突域</li>
</ul>
</li>
</ul>
<p>物理层设备既不能分割 冲突域 又不能分割 广播域。</p>
<h2 id="第3章-数据链路层"><a class="markdownIt-Anchor" href="#第3章-数据链路层"></a> 第3章 数据链路层</h2>
<p>链路 与 数据链路：</p>
<ul>
<li>链路是物理线路；而数据链路是指逻辑上的通路，使用相关硬件与通信协议进行支持</li>
</ul>
<h3 id="31-数据链路层的功能"><a class="markdownIt-Anchor" href="#31-数据链路层的功能"></a> 3.1 数据链路层的功能</h3>
<p>能够加强物理层，改造成逻辑上无差错的数据链路，使之向网络层表现为一条无差错的链路。</p>
<p>数据链路层 向 网络层 提供的服务：</p>
<ul>
<li>无确认的无连接服务，不建立链路连接、收到数据帧<strong>不发回确认</strong>，丢失的帧交给上层处理
<ul>
<li>适用于实时通信，或误码率较低的通信信道，例如 以太网</li>
</ul>
</li>
<li>有确认的无连接服务，不建立链路连接、对收到的数据帧<strong>发回确认</strong>，未收到确认则重传丢失的帧
<ul>
<li>传输可靠性提高，适用于误码率较高的通信信道，例如 无线通信</li>
</ul>
</li>
<li>有确认的面向连接服务，要建立数据链路，发送的每一帧都需要被确认，然后才发送下一帧
<ul>
<li>可靠性最高，适于通信要求较高的场合</li>
</ul>
</li>
<li>（有连接就一定要确认。不存在 无确认的面向连接服务）</li>
</ul>
<p><strong>链路管理</strong>，连接的 建立、维持、释放，用于面向连接的服务。</p>
<ul>
<li>共享物理信道的情况下，链路管理还要负责 通信站点的分配、信道的管理</li>
</ul>
<p><strong>流量控制</strong>，协调通信双方的工作速率和缓存大小的差异，限制发送方的发送速率。</p>
<ul>
<li>不仅是数据链路层具有的功能，高层协议也有提供流量控制功能
<ul>
<li>对于 TCP/IP，仅传输层具有流量控制功能</li>
</ul>
</li>
</ul>
<p><strong>差错控制</strong>，使发送方可以确认是否正确发送了数据。</p>
<ul>
<li>位错，帧中某些位出现了差错
<ul>
<li><s>ARQ 法：发送时附加循环冗余校验码 CRC，发送方 超时重传错误帧</s></li>
</ul>
</li>
<li>帧错，帧的丢失、重复、失序等。引入定时器（超时重传）和编号机制</li>
</ul>
<h3 id="32-组帧"><a class="markdownIt-Anchor" href="#32-组帧"></a> 3.2 组帧</h3>
<p>以帧作为单位传输，可使得出错重传只需重发出错的帧。</p>
<p><strong>组帧</strong>，发送方根据某种规则，将网络层的分组封装成帧。</p>
<ul>
<li>主要解决 帧定界、帧同步、透明传输：
<ul>
<li>帧定界，帧的首尾包含控制信息，有确定边界的作用
<ul>
<li>帧定界符</li>
<li>分组不需要帧定界</li>
</ul>
</li>
<li>帧同步，接收方能从比特流中区分出帧的起始和结尾</li>
<li>透明传输，避免数据本体也出现帧定界符
<ul>
<li>换句话说，就是使得任何比特数据都能在链路上传输</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>实现组帧的方法：</p>
<ul>
<li>字符计数法，在帧头部使用一个计数字段，标明帧内字符数
<ul>
<li>若计数字段出错会直接导致失去同步</li>
</ul>
</li>
<li>字符填充的首位定界符法，使用两个特定字符标识一帧的开始和结束
<ul>
<li>控制字符 SOH 表示帧的首部开始，EOT 表示结束，ESC 进行转义</li>
<li>意味着帧需要以字符为单位编码。复杂、不易兼容，不常用</li>
</ul>
</li>
<li>零比特填充的首位标志法，用特殊的比特串 01111110 标志一帧的开始和结束
<ul>
<li>不需要用字符编码，帧内可包含任意长度的比特</li>
<li>为了避免信息位中也出现 01111110，发送方的数据链路层在 5 个连续的 1 后添加 0</li>
<li>便于硬件实现，性能优于字符填充法</li>
</ul>
</li>
<li>违规编码法，在物理层上实现分组，使用没被定义的电平信号
<ul>
<li>例如曼彻斯特编码不允许码元中心不发生突变，则 “高-高” 和 “低-低” 电平 可用于定界
<ul>
<li>用于局域网 IEEE 802 标准</li>
</ul>
</li>
<li>仅适于采用冗余编码的特殊编码环境</li>
</ul>
</li>
</ul>
<h3 id="33-差错控制"><a class="markdownIt-Anchor" href="#33-差错控制"></a> 3.3 差错控制</h3>
<p>对传输错误采取措施。主要考虑比特差错。</p>
<p>措施通常分为 自动重传请求 ARQ、前向纠错 FEC。</p>
<ul>
<li>ARQ 能发现错误并要求重发，FEC 能确定错误的比特位置 并加以纠正</li>
</ul>
<p>所以可以说，差错控制分为：检错编码、纠错编码。</p>
<p><strong>检错编码</strong>，使用冗余位判断是否出错。</p>
<ul>
<li>奇偶校验码。奇校验：信息与校验位共有奇数个 1；偶校验：信息与校验位共有偶数个 1</li>
<li>循环冗余码 CRC（Cyclic Redundancy Code），有纠错功能，但数据链路层仅用到了检错功能
<ul>
<li>通信双方约定一个“除数”，信息码和校验码共同作为“被除数”，校验时判断余数是否为 0
<ul>
<li>模 2 除法：各个位取异或</li>
</ul>
</li>
<li>做题时，
<ul>
<li>校验码位数 = “除数” 位数 - 1</li>
<li>信息码右侧添上校验码位数的 0，用 “除数” 除以 信息码，余数即是校验码</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>纠错编码</strong>，主要是海明码。能进行 1 位纠错、2 位检错</p>
<ul>
<li>海明码需要的位数：若信息位 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>，额外 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>，则应满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>r</mi></msup><mo>≥</mo><mi>k</mi><mo>+</mo><mi>r</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^r≥k+r+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.800362em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>
<ul>
<li>只能进行 1 位纠错。要两位纠错需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 位</li>
</ul>
</li>
<li>确定校验位的位置：在最终编码的位置为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>…</mo></mrow><annotation encoding="application/x-tex">2^{i-1},i=1,2,…</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.019104em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.824664em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span></span></span></span></li>
<li>获取海明码：
<ul>
<li>首先确定各位与各个校验码的关系（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">M_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示最终编码的对应位）：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示成 0001，则只与第一个校验码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 有关；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">M_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示成 0010，则只与第二个校验码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 有关；</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示成 0011，则与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">e_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 有关；</li>
<li>……</li>
</ul>
</li>
<li>然后对于各个校验码，将与它有关的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> 编码位用异或符号 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⨁</mo></mrow><annotation encoding="application/x-tex">\bigoplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span></span></span></span> 连接计算：
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo>=</mo><msub><mi>M</mi><mn>1</mn></msub><mo>⨁</mo><msub><mi>M</mi><mn>3</mn></msub><mo>⨁</mo><msub><mi>M</mi><mn>5</mn></msub><mo>⨁</mo><msub><mi>M</mi><mn>7</mn></msub><mo>⨁</mo><msub><mi>M</mi><mn>9</mn></msub></mrow><annotation encoding="application/x-tex">e_1=M_1\bigoplus M_3\bigoplus M_5\bigoplus M_7\bigoplus M_9</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">9</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>……</li>
</ul>
</li>
<li>如果海明码没有错误信息，各个校验码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span> 都为 0；若有错，例如 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>3</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">e_3=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 其余都是 0，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 有误</li>
<li>例，101101 的海明码为 0010011101</li>
</ul>
</li>
<li>检错：
<ul>
<li>各个校验码为 0，则无误</li>
<li>例如校验码 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>e</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>e</mi><mn>3</mn></msub><msub><mo separator="true">,</mo><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">e_1,e_2,e_3,_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct"><span class="mpunct">,</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 构成了 0011，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">M_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 出错</li>
</ul>
</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi></mrow><annotation encoding="application/x-tex">e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">e</span></span></span></span> 校验码、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span> 原编码、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span> 最终编码：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mn>7</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>6</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>5</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>4</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>3</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>2</mn></msub><mtext> </mtext><msub><mi>M</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">M_7\ M_6\ M_5\ M_4\ M_3\ M_2\ M_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">6</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>D</mi><mn>4</mn></msub><mtext>  </mtext><msub><mi>D</mi><mn>3</mn></msub><mtext>  </mtext><msub><mi>D</mi><mn>2</mn></msub><mtext>  </mtext><msub><mi>e</mi><mn>3</mn></msub><mtext>  </mtext><msub><mi>D</mi><mn>1</mn></msub><mtext>  </mtext><msub><mi>e</mi><mn>2</mn></msub><mtext>   </mtext><msub><mi>e</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">D_4\ \ D_3\ \ D_2\ \ e_3\ \ D_1\ \ e_2\ \ \ e_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mspace"> </span><span class="mspace"> </span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="34-流量控制-可靠传输机制"><a class="markdownIt-Anchor" href="#34-流量控制-可靠传输机制"></a> 3.4 流量控制、可靠传输机制</h3>
<p><strong>流量控制</strong>，其基本方法是 由 接收方 控制 发送方 发送数据的速率。常见方式如下：</p>
<ul>
<li>停止 - 等待流量控制
<ul>
<li>发送每一帧都要等待应答信号，之后才能发送下一帧</li>
<li>效率低</li>
</ul>
</li>
<li>滑动窗口流量控制
<ul>
<li>发送方 随时发送一连串的帧，称为发送窗口；接收方 允许接收一连串的帧，称为接收窗口
<ul>
<li>发送窗口
<ul>
<li>窗口大小决定了 收到应答之前 最多向前发送的数据帧数</li>
<li>每收到一个确认帧，发送窗口就向前滑动一个帧的位置</li>
</ul>
</li>
<li>接收窗口
<ul>
<li>接收到的帧 只有其帧序号落入窗口内时才会被收下</li>
<li>每收到一个帧，接收窗口就向前滑动一个帧的位置，并发回确认帧</li>
</ul>
</li>
</ul>
</li>
<li>也就是说，发送方不等这一帧的应答，继续发送接下来的帧。接收方依次应答每一帧</li>
<li>窗口大小 = 发送窗口大小 + 接收窗口大小。<strong>帧的编码上限 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">2^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.664392em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span> 是窗口大小最大值</strong></li>
<li>特性：
<ul>
<li>当接收窗口大小为 1 时，可以保证帧的有序接收</li>
<li>与传输层的滑动窗口不同，数据链路层的窗口大小 在传输时是固定的</li>
<li>不同的窗口选择：
<ul>
<li>停止 - 等待协议：发送窗口大小 = 1、接收窗口大小 = 1</li>
<li>后退 N 帧协议 GBN：发送窗口大小 &gt; 1、接收窗口大小 = 1</li>
<li>选择重传协议 SR：发送窗口大小 &gt; 1、接收窗口大小 &gt; 1</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>可靠传输机制</strong>，数据链路层的可靠传输使用 确认 和 自动重传 两种机制完成。</p>
<ul>
<li>确认，一种控制帧，告知发送方哪些内容被正确接收
<ul>
<li>捎带确认，为了提高传输效率，将确认捎带在一个回复帧中</li>
</ul>
</li>
<li>自动重传 / 超时重传（Automatic Repeat reQuest, ARQ），重传出错帧
<ul>
<li>自动重传分为三种：停止-等待、后退 N 帧、选择性重传。后两者结合了滑动窗口技术
<ul>
<li>由于窗口尺寸足够大，又称为 连续 ARQ 协议</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>实际的有限网络中，数据链路层很少采用可靠传输。</p>
<p>关于三种协议，停止-等待、后退 N 帧、选择重传：</p>
<ul>
<li>停止-等待协议，
<ul>
<li>对帧的编号只需要 1bit 长度，因为只需要判断是这一帧还是下一帧</li>
</ul>
</li>
<li>后退 N 帧协议 GBN，保证帧的有序接收
<ul>
<li>发送方对发送的每一帧都设置超时计时器</li>
<li>接收方可在正确接收多个帧后 只对最后一个帧发回确认信息</li>
<li>若用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>bit 对帧编号，则发送窗口尺寸最大为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mi>n</mi></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^n-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.747722em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>
<ul>
<li><strong>注意要少一个</strong>。为了让接收端分清发送的是旧帧还是新帧</li>
</ul>
</li>
</ul>
</li>
<li>选择重传协议 SR，设置计时器，避免重传已正确传输的数据帧，
<ul>
<li>发送方对发送的每一帧都设置超时计时器</li>
<li>发送窗口与接收窗口 尺寸大小相同</li>
<li>若用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span>bit 对帧编号，则窗口尺寸最大为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mrow><mi>n</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">2^{n-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>
<ul>
<li>例如极端情况：发送窗口所有帧都出错。保证接收方分得清发送的是旧帧还是新帧</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>关于信道利用率：= (数据长度 / 信道速率) / 传输该轮数据所需总时间。</p>
<p>做题时，注意单位 B 意味着字节，相比于 bit 要乘 8。</p>
<h3 id="35-介质访问控制mac"><a class="markdownIt-Anchor" href="#35-介质访问控制mac"></a> 3.5 介质访问控制（MAC）</h3>
<p>介质访问控制（Medium Access Control, MAC），将共享同一介质的不同信号相互隔离，避免干扰。</p>
<ul>
<li>静态划分信道的方法：信道划分 介质访问控制</li>
<li>动态分配信道的方法：随机访问 介质访问控制、轮询访问 介质访问控制</li>
</ul>
<p><strong>信道划分 介质访问控制</strong>，根据信道隔离，通过 时域、频域 进行划分。</p>
<ul>
<li>多路复用，一条介质上同时携带多个传输信号</li>
<li>信道划分 介质访问控制，分为 4 种：
<ul>
<li><strong>频分多路复用 FDM</strong>，将信号调制到不同频率载波上
<ul>
<li>适于模拟信号</li>
<li>保护频带，为防止子信道间的干扰，相邻信道间存有间隔</li>
<li>该方法充分利用了带宽，效率高；技术成熟，实现容易</li>
</ul>
</li>
<li><strong>时分多路复用 TDM</strong>，按时间分成若干时间片，轮流分配使用
<ul>
<li>适于数字信号</li>
<li>由于计算机数据的突发性，这样直接分割会导致信道利用率低下</li>
<li><strong>统计时分多路复用 / 异步时分多路复用 STDM</strong>，是 TDM 的改进，按需动态分配时间片
<ul>
<li>换句话说，TDM 下 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">n</span></span></span></span> 个用户只能分得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{1}{n}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span> 的带宽，而 STDM 下最高速率可跑满</li>
</ul>
</li>
</ul>
</li>
<li><strong>波分多路复用 WDM</strong>，即光的频分多路复用，在一根光纤中传输不同波长的光信号</li>
<li><strong>码分多路复用 CDM</strong>，采用不同的编码区分各个信号。多用 码分多址 CDMA 的方案
<ul>
<li>码分多址 CDMA，每个站点被指定一个<strong>唯一</strong>的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">m</span></span></span></span> 位代码（切片序列 /码片序列）
<ul>
<li>传输这个序列表示 1，传输这个序列的反码表示 0</li>
<li>序列被表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>±</mo><mn>1</mn><mo separator="true">,</mo><mo>±</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(±1,±1,…)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">±</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">±</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mclose">)</span></span></span></span>
<ul>
<li>各个站点的序列的选择：要求相互正交</li>
</ul>
</li>
<li>传输的各个站点的信息，会被叠加</li>
<li>判断是否传输了某个序列：对 传输结果 与 序列 求规格化内积，为 0 则没有传输
<ul>
<li>规格化内积：视序列为向量，点乘后除以维度。与自己的规格化内积永远为 1</li>
</ul>
</li>
</ul>
</li>
<li>码分复用的频谱利用率高、抗干扰强、保密性好，主要用于无线通信系统</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>随机访问 介质访问控制</strong>，重复反复地发送帧，竞争信道使用权。</p>
<ul>
<li>所以，相关的协议被称为<strong>争用型协议</strong></li>
<li>常用协议：
<ul>
<li><strong>ALOHA 协议</strong>，不检测信道是否空闲，直接发送
<ul>
<li>纯 ALOHA 协议，随意往信道发数据，若确认超时 则等段时间再发送
<ul>
<li>吞吐量很低</li>
</ul>
</li>
<li>时隙 ALOHA 协议，同步各站时间，将时间划为等长的 <em>时隙 Slot</em>，只在时隙开始时发送
<ul>
<li>减少了冲突可能性，提高了信道利用率</li>
</ul>
</li>
</ul>
</li>
<li><strong>CSMA 协议</strong>，发送前监听一下信道，信道空闲再发送
<ul>
<li>1-坚持 CSMA，持续监听信道，若空闲就立马发送数据（发送概率为 1）
<ul>
<li>极有可能多个结点同时发送数据，导致冲突</li>
</ul>
</li>
<li>非坚持 CSMA，监听一次信道，若空闲则立马发送，若正忙则等待一个随机时间再监听
<ul>
<li>通过增加通信延迟，来提高信道利用率</li>
</ul>
</li>
<li>p-坚持 CSMA，监听一次信道，若空闲则以概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> 发送数据，以概率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>−</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">1-p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">p</span></span></span></span> 推迟
<ul>
<li>用于时分信道（时隙信道）。推迟是指：推迟到下一个时隙再进行一次监听</li>
<li>试图克服非坚持 CSMA 的高延迟</li>
</ul>
</li>
</ul>
</li>
<li><strong>CSMA/CD 协议</strong>，比起 CSMA 多了碰撞检测 Collision Detection
<ul>
<li><strong>碰撞检测</strong>，“边听边发”，发送数据时持续检测信道
<ul>
<li>发送数据后的一小段时间内，仍有可能发生碰撞</li>
<li>采用 CSMA/CD 协议的以太网只能进行 半双工通信</li>
</ul>
</li>
<li><strong>争用期 / 冲突窗口 / 碰撞窗口</strong>，至多经过端到端往返时延 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">2τ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 时间，就可以知道所发送的帧是否发生了冲突
<ul>
<li>只有经过争用期且未检测到碰撞，才能确定本次发送不会发生碰撞</li>
</ul>
</li>
<li><strong>最小帧长</strong>，= 争用期 × 传输速率。收到小于最小帧长的帧时，当作无效帧丢弃
<ul>
<li>这样想：发送方最久需要 争用期 的时间才能发现冲突，在这之前不能完成发送</li>
<li>以太网的最小数据帧长度为 64B</li>
</ul>
</li>
<li>发送过程中若出现冲突，立马终止发送，广播拥塞信号，用指数退避算法 计算退避时间
<ul>
<li><strong>二进制指数退避算法</strong>，思路如下：
<ul>
<li>首先确定基本退避时间，一般取两倍的端到端传播时延 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>τ</mi></mrow><annotation encoding="application/x-tex">2τ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span>，即争用期</li>
<li>重传次数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">[</mo><mtext>重传次数</mtext><mo separator="true">,</mo><mn>10</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">k=\min[重传次数,10]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">[</span><span class="mord cjk_fallback">重</span><span class="mord cjk_fallback">传</span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">数</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mclose">]</span></span></span></span>，即不超过 10</li>
<li>从集合 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msup><mn>2</mn><mi>k</mi></msup><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,1,…,2^k-1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> 中选出一个数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></li>
<li>此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi>r</mi><mi>τ</mi></mrow><annotation encoding="application/x-tex">2rτ</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal" style="margin-right:0.1132em;">τ</span></span></span></span> 即为退避时间</li>
</ul>
</li>
<li>若重传次数达到 16 且都失败，将向高层报告出错</li>
<li>可以得知，连续重传的次数越多，越有可能推迟更久时间（动态退避）</li>
</ul>
</li>
</ul>
</li>
<li><strong>CSMA/CA 协议</strong>，将碰撞检测换为了碰撞避免 Collision Avoidance，更适适合无线局域网
<ul>
<li>无线传输时，碰撞检测花费更大，且有隐蔽站问题</li>
<li>使用链路层确认/重传 ARQ 方案，每发送一帧都要等待确认帧</li>
<li><strong>碰撞避免</strong>，从设计上就要降低碰撞的发生概率
<ul>
<li>802.11 无线局域网不进行碰撞检测，一旦开始发送就不会停下来</li>
<li>802.11 规定，发送完一帧后要等待一个帧间间隔，才能发送下一帧
<ul>
<li><strong>帧间间隔 IFS</strong>，其长短取决于发送的帧的类型。802.11 有 3 种 IFS：
<ul>
<li>SIFS，短IFS，长度最短，用来分隔在同一对话内的各帧</li>
<li>PIFS，点协调 IFS，在 PCF 操作种使用</li>
<li>DIFS，分布式协调 IFS，长度最长，用于异步帧竞争访问的时延</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>CSMA/CA 的退避算法</strong>
<ul>
<li>在这些情况下执行：欲发送第一个帧时信道正忙、重传、发送下一帧前</li>
<li>仅这个情况下不执行：欲发送第一个帧且信道空闲</li>
</ul>
</li>
<li>CSMA/CA 算法的具体过程如下：
<ul>
<li>欲发送第一个帧，且信道空闲，在等待时间 DIFS 后就发送整个数据帧</li>
<li>检测到信道正忙，或是发送不是第一帧前检测到信道空闲：
<ul>
<li>进入争用窗口，选择争用窗口中的某个时隙</li>
<li>根据所选时隙会有一个退避时间，相当于设置了一个 退避计时器</li>
<li>每经历一个时隙的时间就检测一次信道：
<ul>
<li>信道空闲，继续倒计时</li>
<li>信道正忙，冻结倒计时，等待信道空闲后再经过时间 DIFS 继续倒计时</li>
</ul>
</li>
<li>退避计时器减小到 0 时，站点立即发送整个帧、等待确认</li>
</ul>
</li>
</ul>
</li>
<li><strong>隐蔽站问题</strong>，两个站点距离较远，相互感知不到对方，无法检测到冲突
<ul>
<li>解决方法：802.11 允许站点对信道进行预约
<ul>
<li>发送站 广播一个简短的 <em>请求发送</em> RTS（Request To Send）控制帧
<ul>
<li>帧内有 源地址、目的地址、通信持续时间（包含确认帧）</li>
</ul>
</li>
<li>目标站 广播一个 <em>允许发送</em> CTS（Clear To Send）控制帧
<ul>
<li>收到 CTS 的其它站点将在 CTS 帧指明的时间内抑制发送</li>
</ul>
</li>
</ul>
</li>
<li>会降低通信效率，信道预约不是强制性的。当数据帧很长时，信道预约有较大优势</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>轮询访问 介质访问控制，主要是令牌传递协议。</p>
<ul>
<li><strong>令牌传递协议</strong>，环形网上通过一个令牌保证公平传输
<ul>
<li>令牌 Token，仅用作控制信道的 MAC 控制帧，确保同一时刻只有一个站点独占信道
<ul>
<li>站点只有拥有令牌才能发送数据帧
<ul>
<li>在令牌中附加要传输的数据，修改令牌的一个标志位，然后释放令牌</li>
</ul>
</li>
<li>令牌在网环上按顺序依次传递</li>
</ul>
</li>
<li>所有站点都不需要发送数据时，令牌不断在环形网上游荡</li>
<li>同时仅一个结点能发送数据，适于高负载的背景</li>
</ul>
</li>
</ul>
<p>ALOHA，Additive Link On-line HAwaii system<br />
CSMA，Carrier Sense Multiple Access，载波侦听多路访问<br />
CSMA/CD，…… with Collision Detection，载波侦听多路访问/碰撞检测<br />
IFS，InterFrame Space，帧间间隔</p>
<h3 id="36-局域网"><a class="markdownIt-Anchor" href="#36-局域网"></a> 3.6 局域网</h3>
<p>局域网 LAN，Local Area Network，小范围内组成的资源信息共享网络。</p>
<ul>
<li>特点：
<ul>
<li>站点共享较高总带宽</li>
<li>时延较低、误码率较低</li>
<li>各站平等，而非主从关系</li>
<li>能进行广播和组播</li>
</ul>
</li>
<li>拓扑主要分为：星形结构（有一个中心结点）、环形结构、总线形结构、星形和总线形复合结构</li>
<li>主流传输介质为 双绞线</li>
<li>介质访问控制方法：CSMA/CD、令牌总线、令牌环</li>
</ul>
<p><strong>以太网</strong>，使用范围最广的局域网。<strong>几乎是局域网的代名词</strong>。</p>
<ul>
<li>逻辑上采用总线形拓扑结构，网中所有计算机共享一条总线</li>
<li>信息以广播方式发送，使用 CSMA/CD 方式对总线进行访问控制</li>
<li>通常，<em>802.3 局域网简称为以太网</em></li>
</ul>
<h4 id="以太网-与-ieee-8023"><a class="markdownIt-Anchor" href="#以太网-与-ieee-8023"></a> 以太网 与 IEEE 802.3</h4>
<p><strong>IEEE 802.3 标准</strong>，一种局域网标准，描述物理层和数据链路层的 MAC 子层的实现方法。</p>
<ul>
<li>IEEE 802 标准定义的局域网参考模型，只对应 OSI 参考模型的 数据链路层 和 物理层</li>
<li>数据链路层 被拆分为了两个子层：逻辑链路控制 LLC 子层、媒体接入控制 MAC 子层
<ul>
<li>逻辑链路控制 LLC，向网络层提供连接服务，包括：无确认无连接、面向连接、带确认无连接、差错控制、给帧加序号
<ul>
<li><strong>现代局域网中 LLC 子层已经作用不大</strong>，许多网卡仅有 MAC 协议而没有 LLC 协议</li>
</ul>
</li>
<li>媒体接入控制 MAC，屏蔽物理层差异，提供对物理层的统一访问接口，功能包括：组帧和拆卸帧、比特传输差错检测、透明传输</li>
</ul>
</li>
</ul>
<p>以太网简化通信的措施，</p>
<ul>
<li>采用无连接的工作方式，不对发送的数据帧编号，不要求接收方发回确认，提供不可靠服务
<ul>
<li>差错纠正由高层完成</li>
</ul>
</li>
<li>发送的数据使用 曼彻斯特编码，便于提取同步信号</li>
</ul>
<p>以太网的传输介质：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">10BASE5</th>
<th style="text-align:center">10BASE2</th>
<th style="text-align:center">10BASE-T</th>
<th style="text-align:center">10BASE-FL</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">传输介质</td>
<td style="text-align:center">基带同轴电缆（粗缆）</td>
<td style="text-align:center">基带同轴电缆（细缆）</td>
<td style="text-align:center">非屏蔽双绞线</td>
<td style="text-align:center">光纤对</td>
</tr>
<tr>
<td style="text-align:center">编码</td>
<td style="text-align:center">曼彻斯特编码</td>
<td style="text-align:center">曼彻斯特编码</td>
<td style="text-align:center">曼彻斯特编码</td>
<td style="text-align:center">曼彻斯特编码</td>
</tr>
<tr>
<td style="text-align:center">拓扑结构</td>
<td style="text-align:center">总线形</td>
<td style="text-align:center">总线形</td>
<td style="text-align:center">星形</td>
<td style="text-align:center">点对点</td>
</tr>
<tr>
<td style="text-align:center">最大段长</td>
<td style="text-align:center">500m</td>
<td style="text-align:center">185m</td>
<td style="text-align:center">100m</td>
<td style="text-align:center">2000m</td>
</tr>
<tr>
<td style="text-align:center">最多结点数</td>
<td style="text-align:center">100</td>
<td style="text-align:center">30</td>
<td style="text-align:center">2</td>
<td style="text-align:center">2</td>
</tr>
</tbody>
</table>
<ul>
<li><code>10</code>，10Mbps</li>
<li><code>Base</code>，基带信号（未经调制）</li>
<li><code>5</code> <code>2</code>，单段网线的最大长度（百米）</li>
<li><code>T</code>，Twisted-pair 双绞线</li>
<li><code>FL</code>，Fiber Line 光纤线</li>
</ul>
<p>以太网的网卡，工作在数据链路层的硬件，</p>
<ul>
<li>又称为 网络适配器 Adapter 或 网络接口卡 NIC（Network Interface Card）</li>
<li>功能：
<ul>
<li>重要功能是 进行数据的串并转换</li>
<li>其它功能有 帧的收发、帧的封装与拆封、介质访问控制、数据的编码解码、数据缓存</li>
</ul>
</li>
<li>网卡只关注比特，不关心高层协议，所以也工作在物理层</li>
</ul>
<p><strong>介质访问控制 MAC 地址</strong>，也称 物理地址，是网卡出厂时设定的唯一的代码。</p>
<ul>
<li>数据链路层设备（网桥、交换机等）使用 MAC 地址进行通信</li>
<li>MAC 地址长 6 字节，形如 <code>02-60-8c-e4-b1-21</code> 用 12 个十六进制数表示
<ul>
<li>高 24bit 是厂商代码，低 24bit 是网卡序列号</li>
</ul>
</li>
<li><strong>MAC 帧</strong>，由于总线上使用广播通信，因此网卡只收下发往自己的 MAC 帧</li>
<li>以太网 MAC 帧的格式标准：
<ul>
<li>DIX Ethernet V2 标准（以太网 V2 标准）
<ul>
<li>帧组成：
<ul>
<li>目的地址6B、源地址6B、类型2B、数据（IP 数据报）46~1500B、校验码FCS 4B</li>
<li>关于数据部分的 46B 限制：以太帧的长度下限在 64B，可算得 46</li>
<li>校验码采用 32 位循环冗余码 CRC。不校验前导码</li>
</ul>
</li>
<li>前导码，在帧前面插入 8 个字节，以使收发端时钟同步
<ul>
<li>前 7 字节为 <em>前同步码</em>，用于快速实现 MAC 帧的比特同步</li>
<li>最后 1 字节是 <em>帧开始定界符</em>，表示 MAC 帧由此开始
<ul>
<li>提示：<strong>MAC 帧不需要帧结束符</strong>。因为以太网传输本身会留有间隙</li>
<li>但 MAC 帧本身是需要 首部 和 尾部 的</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>IEEE 802.3 标准。在实践中与 DIX 机制并存
<ul>
<li>帧组成：
<ul>
<li>目的地址6B、源地址6B、长度、数据（IP 数据报）、校验码FCS</li>
<li>长度域 指出 数据域 的长度</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>高速以太网，速率达到或超过 100Mb/是的以太网。</p>
<ul>
<li>100BASE-T 以太网，使用双绞线传输基带信号，拓扑为星形
<ul>
<li>支持全双工方式，此时不使用 CSMA/CD 协议</li>
<li>MAC 帧格式以 802.3 标准规定。最短帧长不变，但单段网线最大长度缩减到 100m</li>
</ul>
</li>
<li>吉比特以太网 / 千兆以太网，允许 1Gb/s 速率下用全双工或半双工方式工作
<ul>
<li>与 10BASE-T 与 100BASE-T 技术兼容</li>
<li>使用 802.3 协议规定的帧格式</li>
</ul>
</li>
<li>10 吉比特以太网，只工作在全双工方式，只使用光纤作为传输媒体
<ul>
<li>与 10Mb/s、100Mb/s、1Gb/s 以太网的帧格式完全相同</li>
<li>保留了 802.3 标准规定的以太网最小和最大帧长，便于升级</li>
</ul>
</li>
</ul>
<h4 id="ieee-80211-无线局域网"><a class="markdownIt-Anchor" href="#ieee-80211-无线局域网"></a> IEEE 802.11 无线局域网</h4>
<p>根据设施是否移动，无线局域网分为：</p>
<ul>
<li>有固定基础设施无线局域网，通信须经过基站（即接入点 AP）
<ul>
<li>802.11 系列协议标准，包括 802.11a/b/g/n
<ul>
<li>使用 802.11 系列协议的局域网又称为 Wi-Fi</li>
</ul>
</li>
<li>802.11 下：
<ul>
<li>使用星形拓扑，其中心称为<strong>接入点 AP</strong>（Access Point）</li>
<li>在 MAC 层使用 CSMA/CA 协议</li>
<li>无线局域网的最小构件是<strong>基本服务集 BSS</strong>（Basic Service Set）
<ul>
<li>一个 BSS 覆盖的地理范围称为一个<strong>基本服务区 BSA</strong>（Basic Service Area）
<ul>
<li>其直径一般不超过 100m</li>
</ul>
</li>
<li>一个基本服务集 BSS 包含一个接入点 AP 和若干移动站点
<ul>
<li>要为 AP 分配一个不超 32 字节的<strong>服务集标识符 SSID</strong>（Server Set IDentifier）</li>
</ul>
</li>
<li>不论是本 BSS 内的通信还是跨 BSS 通信，都必须通过本 BSS 的AP</li>
</ul>
</li>
<li>BSS 可独立存在，也可经过 AP 连接到一个<strong>分配系统 DS</strong>（Distribution System）
<ul>
<li>以此连接另一个 BSS，整体构成一个<strong>扩展的服务集 ESS</strong>（Extended Service Set）</li>
<li>也就是说，分配系统 DS 提供了两个接入点 AP 相互通信的通道
<ul>
<li>AP 之间使用有线传输</li>
</ul>
</li>
</ul>
</li>
<li><strong>门户 Portal</strong>，使得 AP 接入到有线的以太网</li>
<li>漫游，移动站的接入点 AP 发生改变，即漫游到了另一个基本服务集 BSS</li>
</ul>
</li>
</ul>
</li>
<li>无固定基础设施移动自组织网络，没有接入点 AP
<ul>
<li>又称 自组网络 ad hoc network</li>
<li>各个移动站（结点）低位平等，都具有路由器的功能，都能作为中间结点进行转发</li>
<li>与移动 IP 的区别：移动 IP 技术用在漫游，使得主机可连接到因特网</li>
</ul>
</li>
</ul>
<p>802.11 局域网的 MAC 帧，</p>
<ul>
<li>有三种类型：数据帧、控制帧、管理帧
<ul>
<li>数据帧的格式：
<ul>
<li>MAC 首部（30B）：
<ul>
<li>帧控制2B、持续期2B、地址1 6B、地址2 6B、地址3 6B、序号控制2B、地址4 6B
<ul>
<li>帧控制，包含诸如 协议版本、去往AP、来自AP 等标志</li>
<li><strong>关于这四个地址的前 3 个地址</strong>：
<ul>
<li>地址 1：接收地址；地址 2 发送地址</li>
<li>当 去往AP=0、来自AP=1 时，地址3 为帧起源的 源地址</li>
<li>当 去往AP=1、来自AP=0 时，地址3 为帧的最终 目的地址</li>
<li>即地址 3 总是 最终地址 与 起源地址 的其中一个。做题时看选哪个有意义</li>
</ul>
</li>
<li>对比 802.3 帧的地址：<strong>都是先 目标 后 来源，但 802.11 多了个地址 3</strong></li>
</ul>
</li>
</ul>
</li>
<li>帧主体 0~2312B</li>
<li>MAC 尾部：帧检验序列 FCS 4B</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="vlan虚拟局域网-virtual-lan"><a class="markdownIt-Anchor" href="#vlan虚拟局域网-virtual-lan"></a> VLAN，虚拟局域网 Virtual LAN</h4>
<p><strong>虚拟局域网 VLAN</strong>，Virtual LAN，把较大的局域网分割成逻辑上的较小的广播域。</p>
<ul>
<li>冲突域与广播域：
<ul>
<li>冲突域上的所有工作站连接在同一根导线上，即同属于一个网段；
<ul>
<li>属于物理层</li>
</ul>
</li>
<li>广播域是指所有能收到 <em>广播信息</em>（无视交换机等的过滤）的结点的集合，可以跨网段
<ul>
<li>属于数据链路层</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>802.3ac 为以太网 802.3 的的扩展，其以太帧多了一个 4B 的标识符，位于源地址和类型字段之间。</p>
<ul>
<li>以太帧的最大帧长从 1518B 变为了 1522B</li>
<li>多出的标识符被称为<strong>VLAN 标签</strong>
<ul>
<li>前 2B 置为 0x8100，表示这是一个 <em>802.1Q 帧</em></li>
<li>后 2B 中，前 4bit 无意义，后 12bit 是<strong>标识符 VID</strong>，标识该 802.1Q 帧所属哪个 VLAN</li>
</ul>
</li>
</ul>
<p>各主机并不知道自己的 VID，但交换机必须知道。交换机之间的帧交互需要插入 VLAN 标签。</p>
<ul>
<li>即主机发送的是普通 802.3 帧，交换机之间使用 802.1Q 帧</li>
</ul>
<p>同属一个 VLAN 的主机可以跨越交换机，被视为逻辑上的一个广播域。</p>
<ul>
<li><strong>数据链路层设备（例如交换机）不能隔离广播域，但 VLAN 可以</strong></li>
</ul>
<h3 id="37-广域网"><a class="markdownIt-Anchor" href="#37-广域网"></a> 3.7 广域网</h3>
<p><strong>广域网</strong>，覆盖范围很广（远超一个城市的范围）的长距离网络。</p>
<ul>
<li>是因特网的核心部分</li>
<li>广域网不等于互联网。互联网可以连接不同类型的网络（局域网、广域网）</li>
<li>通常使用路由器连接上广域网</li>
</ul>
<p>广域网要考虑的重要问题是，选择最佳路由、根据构造出的转发表对分组进行转发。</p>
<p>广域网的组成：结点交换机、连接这些交换机的链路</p>
<ul>
<li>是结点交换机而不是路由器。两者都用来转发分组，但前者工作在单个网络，后者工作于互联网</li>
<li>链路都是高速链路，可以是上千千米的光纤，可以是卫星链路</li>
</ul>
<p>广域网使用的协议主要在网络层。主要是指实现纠错等功能的控制信息来自于网络层的协议。</p>
<table>
<thead>
<tr>
<th></th>
<th>广域网</th>
<th>局域网</th>
</tr>
</thead>
<tbody>
<tr>
<td>连接方式</td>
<td>点对点连接</td>
<td>普遍采用多点接入技术（共用一根总线）</td>
</tr>
<tr>
<td>OSI</td>
<td>物理层、数据链路层、网络层</td>
<td>物理层、数据链路层</td>
</tr>
</tbody>
</table>
<p>广域网是点对点连接的。为了提高网络的可靠性，一个结点交换机往往与多个结点交换机相连。</p>
<h4 id="ppp-协议"><a class="markdownIt-Anchor" href="#ppp-协议"></a> PPP 协议</h4>
<p><strong>PPP</strong>，Point-to-Point Protocol，用于数据链路层、面向字节的协议，主要用于点对点传输。</p>
<ul>
<li>PPP 协议由三部分组成：
<ul>
<li>链路控制协议 LCP，用于 建立、配置、测试、管理 数据链路</li>
<li>网络控制协议 NCP，PPP 协议允许同时采用多种网络协议，每个协议用相应的 NCP 配置</li>
<li>一个将 IP 数据报封装到串行链路的方法
<ul>
<li>IP 数据报就是 PPP 帧的数据部分，该部分的长度受 最大传送单元 MTU 的限制</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>PPP 帧，</p>
<ul>
<li>因为是点对点的，所以不采用 CSMA/CD 协议，也就没有最短帧的限制（64B）</li>
<li>格式如下：
<ul>
<li>首部，
<ul>
<li>标志F 1B、地址A 1B、控制C 1B、协议 2B</li>
<li>标志F 为 01111110，接收端找到这段就能确定一个帧的位置
<ul>
<li>尾部也有 标志F</li>
</ul>
</li>
<li>地址A 恒为 0xFF</li>
<li>控制字段C 恒为 0x03</li>
</ul>
</li>
<li>信息部分，不超过 1500B
<ul>
<li>须实现透明传输（01111110 转义为 01111101）</li>
</ul>
</li>
<li>尾部，
<ul>
<li>帧校验序列FCS 2B、标志F 1B</li>
<li>FCS 使用循环冗余校验，检验对象：除了校验区本身和首尾的两个 标志F 的所有数据</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>PPP 链路的 建立、使用、撤销 过程：</p>
<ul>
<li>初始状态下，不存在物理层连接</li>
<li>线路检测到信号时，进入建立状态，开始建立物理层连接
<ul>
<li>链路控制协议 LCP 交换配置信息，一旦交换成功，链路即宣告建立</li>
<li>开始链路质量确定阶段，或是说链路认证阶段
<ul>
<li>（可选）LCP 测试链路质量是否能承载网络层的协议</li>
<li>如果用户选择了验证协议，将在本阶段完成</li>
</ul>
</li>
<li>网络控制协议 NCP 阶段，开始使用相应的网络控制协议 NCP 配置网络层协议，如 IP、IPX</li>
<li>配置成功后，即可进行数据传输</li>
</ul>
</li>
<li>数据传输完毕后，线路转为终止状态</li>
</ul>
<p>其它注意事项，</p>
<ul>
<li>PPP 提供差错检测，但不提供纠错功能。不使用帧序号、没有确认机制，是不可靠的传输协议
<ul>
<li>不像 HDLC 几乎硬件的实现方式，PPP 主要由软件（即上层）进行实现</li>
</ul>
</li>
<li>只支持全双工链路</li>
<li>PPP 两段可以运行不同的网络层协议</li>
<li>PPP 是面向字节的，信息字段 不能出现与 标志字段 一致的比特组合
<ul>
<li>默认情况下 PPP 被用在异步线路，此时使用字节填充法 避免</li>
<li>若用于同步线路，利用硬件完成字符填充</li>
</ul>
</li>
</ul>
<h4 id="hdlc-协议略"><a class="markdownIt-Anchor" href="#hdlc-协议略"></a> HDLC 协议（略）</h4>
<h3 id="38-数据链路层设备"><a class="markdownIt-Anchor" href="#38-数据链路层设备"></a> 3.8 数据链路层设备</h3>
<p>网桥，工作在链路层的 MAC 子层，将多个以太网连接为覆盖范围更广的以太网。原来的每个以太网被称为一个个 <em>网段</em>。各个网段相对独立，网桥会检查数据帧是否需要转发到另一个网段。</p>
<p><strong>局域网交换机 / 以太网交换机</strong>，工作在数据链路层，本质上是一个多端口网桥。但比网桥更快。</p>
<ul>
<li>交换机将网络分成小的冲突域，使得每个结点拥有尽可能高的带宽
<ul>
<li>即端口到主机的总带宽不会改变，但可以让用户相当于独享所有带宽</li>
</ul>
</li>
<li>工作过程：从以太端口传来数据帧，检测其源 MAC 和目的 MAC，更新查找表，转发数据帧
<ul>
<li>以太交换机对于结点来说是透明的。因此容易管理</li>
<li>可以方便地实现虚拟局域网 VLAN，隔离冲突域与广播域</li>
<li><strong>查找表 / 交换表</strong>（Switch table），指出 主机 MAC 地址 与 交换机接口 的关系
<ul>
<li>随着所连主机的变化而自动更新。通常每个表项设置有过期时间</li>
<li>每传来一次数据帧，都会检查其源 MAC 地址与传来的接口是否被记入表中</li>
<li>若从表中查询不到数据帧的 目的 MAC 地址，就向其它所有端口转发该帧</li>
</ul>
</li>
</ul>
</li>
<li>工作特点：
<ul>
<li>交换机每个端口都直接与单台主机相连
<ul>
<li>各个端口可并发通信</li>
</ul>
</li>
<li>一般工作在全双工方式</li>
<li>即插即用，动态维护一张帧的转发表</li>
<li>交换机的总容量 随着所连结点数的增加而增加</li>
</ul>
</li>
<li>两种交换模式，
<ul>
<li>直通式交换机，只检查帧的目的地址，尽可能快地转发出去
<ul>
<li>缺乏安全性，不支持具有不同速率的端口的交换</li>
</ul>
</li>
<li>存储转发式交换机，先将帧进行缓存 并检查是否无误，再进行转发
<ul>
<li>可靠性高、支持具有不同速率端口间的转换，但延迟较大</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>数据链路层设备不能隔离广播域，但可以隔离冲突域。</p>
<h2 id="第4章-网络层"><a class="markdownIt-Anchor" href="#第4章-网络层"></a> 第4章 网络层</h2>
<h3 id="41-网络层的功能"><a class="markdownIt-Anchor" href="#41-网络层的功能"></a> 4.1 网络层的功能</h3>
<p>网络层负责实现不同网络的互联，在任意结点间进行数据报传输（不一定可靠，例如 IP 就不可靠）。</p>
<ul>
<li>网络互联，使用中间设备（中继系统）将多个计算机网络构成更大的网络系统</li>
<li>中继系统，根据所在层次分为：
<ul>
<li>（物理层：转发器，集线器）</li>
<li>（数据链路层：网桥、交换机）</li>
<li>网络层：路由器</li>
<li>网络层以上：网关</li>
</ul>
</li>
<li>从网络层的角度看，物理层与数据链路层的中继系统连接的是同一网络，通常不称为网络互联</li>
</ul>
<p>在 TCP/IP 体系中，网络层采用标准化协议，而连接的网络可以是<strong>异构的</strong>（物理层、数据链路层、网络层 协议不同）。</p>
<ul>
<li>路由器互联网络时，各个局域网可以异构，但网络层以上的高层协议必须相同</li>
</ul>
<p>由于参加互联的计算机网络都使用 IP 协议，因此可以把互联后的网络视为 虚拟 IP 网络。</p>
<ul>
<li>虚拟互联网络也就是逻辑互联网络，简称为 <strong>IP 网络</strong></li>
<li>使用 IP 网络的主机进行通信，就像在统一的网络上一样，不必关心各网的异构细节（如编址方案、路由选择协议）</li>
</ul>
<p><strong>路由器</strong>，完成 路由选择、分组转发 的功能。</p>
<ul>
<li>路由选择，按照某些分布式算法，时刻更新网络拓扑，动态改变所选择的路由
<ul>
<li>具体体现为 路由表的更新</li>
<li>因为路由器工作在网络层，其路由表指出的是 IP 地址的路径（下一跳）</li>
</ul>
</li>
<li>分组转发，路由器根据转发表将用户的 IP 数据报从合适的端口转发出去
<ul>
<li>转发表由路由表得出</li>
</ul>
</li>
</ul>
<p>讨论路由选择时，不区分转发表和路由表，<strong>统一使用 路由表 一词</strong>。</p>
<p><strong>软件定义网络 SDN</strong>，路由器不再需要路由选择软件，只需直接查阅转发表并转发分组。</p>
<ul>
<li>可以将网络层划分为：控制层面、数据层面（转发层面）
<ul>
<li>控制层面，实现路由选择</li>
<li>数据层面，实现转发</li>
</ul>
</li>
<li>在 SDN 中，网络的 控制层面 由逻辑上的 <strong>远程控制器</strong> 负责
<ul>
<li>远程控制器掌握整个网络状态，计算最佳路由，将转发表（SDN 中称为<strong>流表</strong>）下发给路由器</li>
</ul>
</li>
<li><strong>SDN 将原本分布式的互联网变为集中控制</strong>。某些网络使用 SDN 模式进行建造，效率更好</li>
<li>SDN 有很好的编程性
<ul>
<li>对于上层开发者，其提供的编程接口称为 <em>北向接口</em></li>
<li>SDN 控制器和转发设备简历双向会话的接口称为 <em>南向接口</em>
<ul>
<li>通过不同的南向接口协议，SDN 控制器就可兼容不同的硬件设备</li>
</ul>
</li>
<li>SDN控制器群内部控制器间的通信接口称为 <em>东西向接口</em>，增强控制层面的可靠性、可拓展性</li>
</ul>
</li>
<li>优点，
<ul>
<li>集中式控制、分布式高速转发，利于控制层面的全局优化，利于高性能的网络转发</li>
<li>灵活可编程。将控制层面和数据层面分离后，网络可以用编程方式配置</li>
<li>控制与数据的分离可实现 设备与软件的分离开发，降低成本</li>
</ul>
</li>
<li>缺点，
<ul>
<li>集中管理容易受到攻击，崩溃会影响整个网络</li>
<li>控制器可能会称为网络性能的瓶颈</li>
</ul>
</li>
</ul>
<p><strong>拥塞</strong>，通信子网中 因出现过量分组而引起的网络性能下降。</p>
<ul>
<li>路由器端口的缓冲区有限，过量分组会导致有大量的分组被抛弃</li>
<li>判断是否处在拥塞状态：观察网络的吞吐量与网络负载的关系
<ul>
<li>网络负载增加，网络吞吐量反而降低，则说明已经开始拥塞</li>
</ul>
</li>
</ul>
<p><strong>拥塞控制</strong>，确保子网能承载所达到的流量，避免由于拥塞而出现的分组丢失、网络死锁。</p>
<ul>
<li>涉及到网络中的所有主机、路由器等，单纯增加资源不能解决拥塞</li>
<li>拥塞控制的方法：
<ul>
<li>开环控制，设计网络之初就考虑拥塞问题，尽量预防发生
<ul>
<li>手段包括 确定何时可接收新流量、何时丢弃分组以及丢弃哪些分组 等</li>
<li>是静态的预防方法，在实际执行时不考虑当前网络的状态</li>
</ul>
</li>
<li>闭环控制，使用监测网络系统，发生拥塞时将拥塞信息传到合适位置，调整网络运行
<ul>
<li>是动态的方法</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="42-路由算法"><a class="markdownIt-Anchor" href="#42-路由算法"></a> 4.2 路由算法</h3>
<p>路由器的转发使用路由表，更新路由表的路由算法可分为：</p>
<ul>
<li>静态路由算法 / 非适应路由算法，由网络管理员手工配置路由信息
<ul>
<li>不能及时适应网络状态的变化，适于简单小型网络</li>
</ul>
</li>
<li>动态路由算法 / 自适应路由算法，路由器之间交换信息，按照一定算法更新路由表</li>
</ul>
<p>常用的动态路由 可分为两类：</p>
<ul>
<li>距离-向量路由算法，结点的路由选择表记录 所有的路由（目的结点）及其代价（距离）
<ul>
<li>结点定期将其<strong>完整的路由选择表</strong>传送给所有<strong>相邻结点</strong>
<ul>
<li>当结点被告知有新的路由，或出现代价更小的路由，就会更新自己的路由选择表</li>
</ul>
</li>
<li>最常见的算法是 RIP 算法，采用 “跳数” 作为距离代价的度量</li>
<li>通信子网的规模越大，向相邻结点发送的更新报文越大</li>
</ul>
</li>
<li>链路状态路由算法，每个结点具有 <em>完全的网络拓扑信息</em>
<ul>
<li>构建过程，
<ul>
<li>首先主动测试所有相邻结点的状态</li>
<li>链路状态变化时，将链路状态传播给<strong>其它所有结点</strong>，其它结点更新自己的网络拓扑
<ul>
<li>链路状态，<strong>与本结点相邻的结点</strong>、及这些链路的状态信息
<ul>
<li>使用 OSPF 算法，链路状态的度量主要用来标识 费用、距离、时延、带宽 等</li>
</ul>
</li>
<li>使用 <em>洪泛法</em> 进行传播：向所有端口发送信息，收到信息的结点再次端口转发</li>
</ul>
</li>
</ul>
</li>
<li>特点，
<ul>
<li>每个结点使用同样的数据独立地计算路径。链路一发生变化就用 Dijkstra 重新计算路由</li>
<li>链路状态报文仅包含那个结点的相邻直接链路的信息，所以报文大小与网络规模无关
<ul>
<li>因此比 距离-向量路由算法 有更好的规模可伸展性</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">距离-向量路由算法</th>
<th style="text-align:center">链路状态路由算法</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">传送<strong>完整的</strong>路由先择表</td>
<td style="text-align:center">只传送相邻的链路信息</td>
</tr>
<tr>
<td style="text-align:center">只向相邻结点发送更新信息</td>
<td style="text-align:center">使用洪泛法<strong>向所有结点广播</strong></td>
</tr>
<tr>
<td style="text-align:center">网络变化不能及时同步，可能出现路由环路</td>
<td style="text-align:center">各个结点拥有完整的网络拓扑</td>
</tr>
<tr>
<td style="text-align:center">通信子网规模越大，发送的更新报文越大</td>
<td style="text-align:center">链路状态报文仅包含相邻直接链路的信息</td>
</tr>
</tbody>
</table>
<p>层次路由，为了适应大规模的网络，按照层次进行路由选择。</p>
<ul>
<li>因特网将整个互联网划分为许多<strong>自治系统</strong>（包含大量局域网），每个自治系统自行决定本系统内采用的路由选择协议</li>
<li>两个自治系统的通信，又需要一种协议来屏蔽之间的差异</li>
<li>所以，因特网把路由选择协议分为了两大类：
<ul>
<li>内部网关协议 / 域内路由选择 IGP，一个自治系统内部所使用的路由选择协议
<ul>
<li>具体的协议有 RIP、OSPF</li>
<li>OSPF 将一个自治系统再划分为若干区域 Area，每个路由器只需知道本区域的拓扑</li>
</ul>
</li>
<li>外部网关协议 / 域间路由选择 EGP，自治系统之间所使用的路由选择协议
<ul>
<li>具体的协议有 BGP</li>
</ul>
</li>
</ul>
</li>
<li>层次路由的方法会使得信息种类繁多、OSPF 协议更为复杂，但可降低各区域内部的通信量
<ul>
<li>因而使 OSPF 协议能用于规模很大的自治系统中</li>
</ul>
</li>
</ul>
<p>路由选择分为 直接交付 和 间接交付。当发送站与目的站在同一网段内时，使用直接交付。</p>
<ul>
<li>即，是否同属于一个子网</li>
<li>通过分组的 IP 地址进行判别</li>
</ul>
<h3 id="43-ipv4"><a class="markdownIt-Anchor" href="#43-ipv4"></a> 4.3 IPv4</h3>
<p>IPv4 是现在普遍使用的 IP 协议。规定了数据传送单位、分组控制的规则。</p>
<h4 id="ip-分组-ip-数据报"><a class="markdownIt-Anchor" href="#ip-分组-ip-数据报"></a> IP 分组 / IP 数据报</h4>
<p>IPv4 分组的组成：首部、数据部分，</p>
<ul>
<li>首部，有 20B 的固定部分，包含若干控制信息，
<ul>
<li>版本，IP 协议的版本（此时为 4）</li>
<li>首部长度，4bit，<strong>以 32 位（4B）为单位</strong>指出首部的总长度
<ul>
<li>最大值为 60B，最常用 20B</li>
</ul>
</li>
<li>总长度，16bit，整个分组的长度，<strong>单位为一字节 1B</strong>
<ul>
<li>以太网帧的 最大传送单元 MTU 为 1500B。不能超过这个数值</li>
</ul>
</li>
<li>标识，16bit。是个累加计数器，为了区分不同的原始数据报，为它们赋予不同的标识
<ul>
<li>不能等价为 “序号”，因为 IP 是无连接服务</li>
<li>对于超出 MTU 而被分片的数据报（来自同一原始数据报），它们拥有相同的标识</li>
</ul>
</li>
<li><strong>标志，3bit。MF=0 表示这是最后一个分片；DF=0 表示允许分片</strong></li>
<li>片偏移，13bit，被分片分组处在原分组中的相对位置。<strong>以 8B 为偏移单位</strong>
<ul>
<li>所以，除最后一个分片外，每个分片的长度一定是 8B 的整倍数</li>
</ul>
</li>
<li>生存时间 TTL，8bit，是个计数器，路由器转发分组前先把 TTL 减 1，变为 0 就丢弃
<ul>
<li>标识分组在网络中的寿命，确保分组不会在网络中循环</li>
</ul>
</li>
<li>协议，8bit，指出该分组的 数据段 所使用的协议，该部分应上交给哪个协议进行处理
<ul>
<li>值为 6 表示TCP，值为 17 表示 UDP</li>
</ul>
</li>
<li>首部校验和，16bit。只校验分组的首部，不校验数据部分</li>
<li>源地址字段，4B，发送方的 IP 地址</li>
<li>目的地址字段，4B，接收方的 IP 地址</li>
</ul>
</li>
</ul>
<p>IP 数据报 的分片，</p>
<ul>
<li>IP 分组本身的最大长度为 68835B（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>16</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^{16}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">6</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>）</li>
<li>分片，当 IP 数据报的总长度大于链路 MTU 时，就需要将数据分到多个较小的 IP 数据报</li>
<li><strong>最大传送单元 MTU</strong>，一个链路层数据报能承载的最大数据量（数据部分长度）
<ul>
<li>因为 IP 数据报 被封装到 链路层的数据报 中，所以 MTU 严格限制了 IP 数据报的长度</li>
<li>以太网的 MTU 为 1500B；许多广域网的 MTU 不超过 576B</li>
</ul>
</li>
<li>片在网络层被重组，使用到了 IP 数据报首部的 标识、标志、片偏移</li>
</ul>
<h4 id="ip-地址-nat"><a class="markdownIt-Anchor" href="#ip-地址-nat"></a> IP 地址、NAT</h4>
<p>IPv4 地址，即 IP 地址。</p>
<ul>
<li>长为 32bit，由 网络号 和 主机号 两部分组成
<ul>
<li>{&lt;网络号&gt;,&lt;主机号&gt;}</li>
</ul>
</li>
<li>具有特殊用途的 IP 地址：
<ul>
<li>主机号全为 0：标识网络本身</li>
<li>主机号全为 1：该网络的 广播地址，又称为 直接广播地址</li>
<li>网络号全为 0：表示 “本网络”</li>
<li>127.×.×.×：环回自检（Loopback Test）地址，表示任意主机本身，即 Localhost</li>
<li>0.0.0.0：表示全网络所有主机，或表示未指定。例如默认路由设为 0.0.0.0</li>
<li>255.255.255.255：表示整个 TCP/IP 网络的广播地址，又称 受限广播地址
<ul>
<li>即，可作为目的地址发送广播</li>
<li>实际使用时，由于路由器对广播域的隔离，255.255.255.255 等效为本网络的广播地址</li>
</ul>
</li>
</ul>
</li>
<li>分类的 IP 地址，按照固定位数，两级分配 网络号和主机号，
<ul>
<li>A 类，(8,24)，不包含网络号字段全为 0 或 1（即 127）的 IP 地址
<ul>
<li>网络号第一位定为 0。网络号从 1 开始，到 126 结束</li>
</ul>
</li>
<li>B 类，(16,16)，不包含网络号字段全为 1 的 IP 地址
<ul>
<li>网络号第一位定为 1，第二位定为 0。即从 128.0 开始，到 191.255 结束</li>
</ul>
</li>
<li>C 类，(24,8)，不包含网络号字段全为 1 的IP 地址
<ul>
<li>网络号前两位定为 1，第三位定为 0。即从 192.0.0 开始，到 233.255.255 结束</li>
</ul>
</li>
</ul>
</li>
<li>IP 地址的特点：
<ul>
<li>IP 地址是关联一台 主机/路由器 和 一条链路 的方式
<ul>
<li>IP 网络上的路由器必然至少具有两个 IP 地址：公网 IP、内网 IP</li>
</ul>
</li>
<li>路由器仅根据目的主机的 网络号 来转发分组，减小了路由表所占空间</li>
<li>同一个 广播域 / 局域网 LAN 上的的设备，它们的 IP 地址的网络号相同</li>
</ul>
</li>
</ul>
<p><strong>网络地址转换 NAT</strong>，通过将内网地址映射到外网地址，使得内网地址可访问互联网。</p>
<ul>
<li>Network Address Translation</li>
<li>使得整个专用网只需一个全球 IP 地址即可连通因特网，大大节省了 IP 地址的消耗
<ul>
<li>与此同时，因为隐藏了内网结构，从而降低了内网受到攻击的风险</li>
</ul>
</li>
<li>私有 IP 地址（即内网地址），也称 可重用地址
<ul>
<li>采用私有 IP 地址的互联网络称为 专用互联网 或 本地互联网</li>
<li>私有 IP 地址可选择不同的规则：
<ul>
<li>A 类，含有 1 个 A 类网段，10.0.0.0 ~ 10.255.255.255</li>
<li>B 类，含有 16 个 B 类网段，172.16.0.0 ~ 172.31.255.255</li>
<li>C 类，含有 256 个 C 类网段，192.168.0.0 ~ 192.168.255.255</li>
</ul>
</li>
<li>路由器对目的地址是私有地址的数据报一律不向外转发</li>
</ul>
</li>
<li>使用 NAT，需要为一个路由器配置至少一个有效的外部全球 IP 地址，并安装 NAT 软件
<ul>
<li><strong>NAT 转换表</strong>，存有本地 IP 地址（LAN 端）到全球 IP 地址（WAN 端）的映射
<ul>
<li>不会自动更新表项，只能由管理员删减</li>
<li>对于查阅不到 IP 地址的分组，会直接丢弃</li>
</ul>
</li>
<li>所以，与普通路由器工作在网络层不同，<strong>NAT 路由器还要转换 传输层 的端口号</strong>
<ul>
<li><strong>NAT 工作在传输层</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="子网划分-掩码-cidr"><a class="markdownIt-Anchor" href="#子网划分-掩码-cidr"></a> 子网划分、掩码、CIDR</h4>
<p>两级 IP 地址空间不够灵活。</p>
<ul>
<li><strong>子网划分</strong>，从主机号额外划分一个 “子网号字段”，使两级 IP 地址变为三级 IP 地址
<ul>
<li>{&lt;网络号&gt;,&lt;子网号&gt;,&lt;主机号&gt;}</li>
<li>IP 数据报按网络号发送到路由器，然后按子网号找到目的子网，最后交付给目的主机
<ul>
<li>子网划分 对外不表现出变化，因为网络号没有改变</li>
</ul>
</li>
<li>一般来说 子网号 不能全为 1 或 0。要看路由选择软件是否支持</li>
<li>主机号全为 0：标识子网的网络号；主机号全为 1：该子网的 广播地址</li>
</ul>
</li>
<li><strong>子网掩码</strong>，与 IP 地址等长（32bit）的二进制串，用来说明如何进行的子网划分
<ul>
<li>例如 <code>192.168.5.56</code> 的子网掩码为 <code>255.255.255.0</code>，可得该主机所在子网的网络号为 <code>192.168.5.0</code></li>
<li>路由器的路由表必须记录子网掩码。即表项内容有 网络地址、子网掩码、下一跳地址</li>
</ul>
</li>
</ul>
<p><strong>无分类编址 CIDR</strong>，消除传统的 A B C 类地址及子网段，网络前缀可任意变换长度。</p>
<ul>
<li>Classless Inter Domain Routing</li>
<li>{&lt;网络前缀&gt;,&lt;主机号&gt;}</li>
<li>斜线记法，或称 CIDR 记法，形如 <code>128.14.32.5/20</code>，此时掩码的 1 有 20 位</li>
<li>可以在内网再次使用 CIDR 划分，以达到 子网划分 的效果</li>
<li><strong>路由聚合</strong>，或称 构成超网，利用掩码将一些 IP 地址视为整体
<ul>
<li>例如 <code>206.1.0.0/17</code> 和 <code>206.1.138.0/17</code>，可聚合成 <code>206.1.0.0/16</code></li>
<li>各聚合分配统一的下一跳，可以节约路由表空间，减少路由器信息交换，提高网络性能
<ul>
<li>越上层的网络，前缀越短、路由表的项目越少</li>
</ul>
</li>
<li><strong>最长前缀匹配 / 最佳匹配</strong>，当聚合的匹配结果不唯一时，选择掩码最长的路由
<ul>
<li>为了效率，路由表中的地址存放在二叉树中，按前缀长度的降序排列</li>
</ul>
</li>
</ul>
</li>
<li>主机号全为 0：标识网络号；主机号全为 1：该网络的 广播地址</li>
</ul>
<h4 id="路由-ip-地址与物理地址-mac"><a class="markdownIt-Anchor" href="#路由-ip-地址与物理地址-mac"></a> 路由、IP 地址与物理地址 MAC</h4>
<p>转发表中的特殊路由，</p>
<ul>
<li>主机路由，形如 <code>a.b.c.d/32</code>，对一个 IP 地址特指一个路由，用于网络的控制和测试</li>
<li>默认路由，<code>0.0.0.0/0</code>，当转发表其它表项都匹配失败时，使用默认路由</li>
</ul>
<p>得到下一跳路由器的 IP 后，要将该 IP 地址通过 ARP 转换成 MAC 地址，将此 MAC 地址放到 MAC 帧首部中，然后根据这个 MAC 地址找到下一跳路由器。</p>
<p>IP 地址与 MAC 地址，</p>
<ul>
<li>IP 层将网络硬件地址体系的差异屏蔽在了网络层之下。在网络层及以上使用 IP 地址即可</li>
<li>IP 分组被路由器转发时，会被重新封装到 MAC 帧中，<strong>MAC 的源地址和目的地址会不断改变</strong>
<ul>
<li>网络层只能 IP 地址寻址。到达目标 LAN 后，通过数据链路层的 MAC 地址以广播形式寻址
<ul>
<li>这决定了 MAC 地址无法跨网络通信</li>
</ul>
</li>
<li>内网的 IP 地址需要向外隐藏。此时的 IP 地址才会被改写</li>
</ul>
</li>
<li>IP 数据报首部包含源 IP 地址，但路由器只根据目的 IP 地址进行转发</li>
<li>一个路由器拥有多个 IP 地址、多个硬件地址</li>
</ul>
<h4 id="arp-dhcp-icmp"><a class="markdownIt-Anchor" href="#arp-dhcp-icmp"></a> ARP、DHCP、ICMP</h4>
<p><strong>地址解析协议 ARP</strong>，工作在网络层，解决同一个局域网上的、从 IP 地址到 MAC 地址的映射。</p>
<ul>
<li>Address Resolution Protocol</li>
<li>原因：数据帧必须使用 硬件地址 进行交付</li>
<li>工作方式，
<ul>
<li>每个主机设有一个 <strong>ARP 表</strong>，存储本局域网上各主机和路由器的 IP 地址到 MAC 地址的映射
<ul>
<li>使用 ARP 动态维护 ARP 表</li>
</ul>
</li>
<li>主机欲发送 IP 数据报，首先检查 ARP 高速缓存（即 ARP 表）是否有目标主机的 IP 地址
<ul>
<li>若有，就可查出对应的硬件地址，并写入 MAC 帧</li>
<li>若没有，广播一个 ARP 请求分组，目标主机回应 ARP 响应分组，以此得到硬件地址
<ul>
<li>ARP 请求分组的首部的目的 MAC 地址为全 1，局域网内所有主机都能收到</li>
<li>ARP 响应分组使用 单播发送（点对点），包含自身 IP 与 MAC 地址的映射关系</li>
<li>收到 ARP 响应分组后将映射写入 ARP 缓存，就可以根据该映射发送 MAC 帧</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>若目标主机不在同一个局域网上，就要通过 ARP 找到与另一个网络相连的路由器
<ul>
<li>剩下的转发工作由另一个网络完成</li>
</ul>
</li>
</ul>
<p>用户不必关心 ARP 实现的地址解析过程，只需知道两个结点通过 IP 地址进行通信。</p>
<p>逆地址解析协议 RARP，做的与 ARP 相反的事。</p>
<p><strong>动态主机配置协议 DHCP</strong>，工作在应用层（基于 UDP），用于给主机动态地分配 IP 地址。</p>
<ul>
<li>Dynamic Host Configuration Protocol</li>
<li>提供了即插即用的联网机制，允许新加入网络的计算机自动获取 IP 地址</li>
<li>工作方式，客户/服务器 模式，
<ul>
<li>需要 IP 地址的主机，向网络广播 <strong>发现报文</strong>。只有 DHCP 服务器应答此报文</li>
<li>DHCP 服务器会尝试在数据库查找该设备的配置信息，并发回 <strong>提供报文</strong>，
<ul>
<li>若找到，直接发回找到的信息</li>
<li>若没有，则从服务器的 IP 地址池中取一个地址，分配给该主机</li>
</ul>
</li>
<li>允许网络上配置多台 DHCP 服务器
<ul>
<li>DHCP 客户机会收到多个应答消息，一般挑选最先达到的应答消息</li>
</ul>
</li>
</ul>
</li>
<li>DHCP 服务器分配的 IP 地址是临时的，
<ul>
<li><strong>租用期</strong>，分配的 IP 地址的有效时间
<ul>
<li>时长由 DHCP 服务器决定，DHCP 客户也可以在发现报文中提出对租用期的要求</li>
</ul>
</li>
</ul>
</li>
<li>DHCP 的客户端和服务端通过 广播 的形式交互
<ul>
<li>不能使用 IP 地址，只能使用广播</li>
<li>TCP 需要建立连接，所以采用 UDP 进行通信</li>
</ul>
</li>
<li>因为是通过 客户/服务器 模式工作的，所以是 应用层 协议</li>
</ul>
<p><strong>网际控制报文协议 ICMP</strong>，工作在网络层，报告传输的差错和异常，提高 IP 数据报交付成功率。</p>
<ul>
<li>Internet Control Message Protocol</li>
<li>表现为 IP 数据报的发送，
<ul>
<li>ICMP 差错报告报文，目标主机或路径上的路由器，向源主机报告出现的异常：
<ul>
<li>终点不可达，具体有 网络不可达、端口不可达、协议不可达 等</li>
<li>源点抑制，路由器或主机因拥塞而丢弃数据报
<ul>
<li>每个被丢弃的数据报都要发回源点抑制报文，以告知源点放慢发包速度</li>
</ul>
</li>
<li>时间超过（超时），路由器收到了生存时间 TTL 为零的数据报，或目标主机未在规定时间内收到数据报的全部分片
<ul>
<li>命令 <code>traceroute</code> 或 <code>tracert</code> 以此跟踪分组经过的路由</li>
</ul>
</li>
<li>参数问题，路由器或主机收到的数据报的首部中，有字段的值不正常</li>
<li>改变路由（重定向），主机的默认路由器发现该数据报该发往另一个路由器，于是默认路由器发回一个 改变路由 ICMP，让主机刷新自己的路由表
<ul>
<li>主机的路由表通过这种方式进行更新</li>
</ul>
</li>
</ul>
</li>
<li>ICMP 询问报文，最常用的是 回送 和 时间戳 报文，
<ul>
<li>回送请求报文 与 回送回答报文，用于源主机判断目的主机或目的路由器能否与其通信
<ul>
<li>命令 <code>ping</code> 就使用此报文</li>
</ul>
</li>
<li>时间戳请求报文 与 时间戳回答报文，确定 IP 数据报在两台机器间的往返时间</li>
<li>地址掩码请求报文 与 地址掩码回答报文</li>
<li>路由询问报文 与 路由通告报文</li>
</ul>
</li>
</ul>
</li>
<li>不发回 ICMP 差错报告报文的情况，
<ul>
<li>对 ICMP 差错报告报文 本身不再发回报文</li>
<li>对于分片的数据报，第一个分片之后的数据报片都不发回 ICMP 差错报告报文</li>
<li>对具有组播地址的数据报都不发送 ICMP 差错报告报文
<ul>
<li>组播 / 多播，比起 广播 向网络所有主机发送数据报，它是给特定的一组主机发送数据</li>
<li>使用形如 <code>172.31.128.255/18</code> 的 CIDR 地址表示组播</li>
</ul>
</li>
<li>对于特殊地址的数据报，如 <code>127.0.0.0</code> <code>0.0.0.0</code> 这些被保留的地址，不发回报文</li>
</ul>
</li>
</ul>
<h3 id="44-ipv6"><a class="markdownIt-Anchor" href="#44-ipv6"></a> 4.4 IPv6</h3>
<p><strong>IPv6</strong>，相比于 IPv4 只有 32bit，增大到了 128bit（16B）。</p>
<ul>
<li><code>4BF5:AA12:0216:FEBC:BA5F:039A:BE9A:2170</code>，就像 MAC 地址（<code>02-60-8c-e4-b1-21</code>）
<ul>
<li>若一段全为 0 则可简写为 <code>…:0:…</code>，或用 <code>…::…</code> 压缩多段连续的 0 值域</li>
<li><code>…::…</code> 在一个 IPv6 地址中只能用一次</li>
</ul>
</li>
<li>不同于 IPv4 允许路由器分片，IPv6 只允许源结点分片</li>
<li>不同于 IPv4 首部长度必须是 4B 的整数倍，IPv6 首部长度必须是 8B 的整数倍
<ul>
<li>首部的域从 12 个降到了 8 个，且可选段增多，有利于路由器更快地处理分组</li>
<li>IPv6 首部没有校验和字段</li>
</ul>
</li>
<li>比 IPv4 有更强大的安全性</li>
</ul>
<p>IPv6 的目的地址类型，比起 IPv6 也有差异，</p>
<ul>
<li>单播，点对点通信，与 IPv4 相同</li>
<li>多播，一对多通信，与 IPv4 相同</li>
<li>任播，目的站是一组计算机，但数据报只交付给其中一台（通常是距离最近的）
<ul>
<li>是 IPv6 新增的类型</li>
</ul>
</li>
<li>没有广播</li>
</ul>
<p>IPv6 扩展了 IPv4 地址分级的概念。前两级可视为网络部分，第三级视为主机部分，</p>
<ul>
<li>第一级（顶级），全球都知道的公共拓扑</li>
<li>第二级（场点级），指明单个场点</li>
<li>第三级，指明单个网络接口</li>
</ul>
<p>IPv4 向 IPv6 的过渡，</p>
<ul>
<li>双协议栈，一台设备上同时装有 IPv4 和 IPv6 协议栈，拥有两种协议的功能</li>
<li>隧道技术，将整个 IPv6 数据报封装到 IPv4 数据报的数据部分</li>
</ul>
<h3 id="45-路由协议自治系统"><a class="markdownIt-Anchor" href="#45-路由协议自治系统"></a> 4.5 路由协议（自治系统）</h3>
<p><strong>自治系统 AS</strong>，Autonomous System，有权自主决定在本系统中采用何种路由协议的小型单位。</p>
<ul>
<li>或是说，是单一技术管理下的一组路由器。一个自治系统下的各个路由器是相互连通的</li>
</ul>
<p>自治系统内部的路由选择称为<strong>域内路由选择</strong>，自治系统之间的路由选择称为<strong>域间路由选择</strong>。</p>
<ul>
<li>内部网关协议 IGP，Interior Gateway Protocol，用于域内路由选择
<ul>
<li>两个自治系统可能使用不同的 IGP</li>
<li>典型协议有 RIP、OSPF</li>
</ul>
</li>
<li>外部网关协议 EGP，External Gateway Protocol，用于域间路由选择
<ul>
<li>自治系统内的某些路由器需要同时运行 IGP 和 EGP</li>
<li>用得做多的协议是 BGP-4</li>
</ul>
</li>
</ul>
<h4 id="内部网关协议rip-ospf"><a class="markdownIt-Anchor" href="#内部网关协议rip-ospf"></a> 内部网关协议（RIP、OSPF）</h4>
<p><strong>路由信息协议 RIP</strong>，Routing Information Protocol，应用层协议，使用 “跳数” 度量距离。</p>
<ul>
<li>网络中的每个路由器都要维护一组 <em>距离向量</em>（路由表），记录自身到其它网络的距离
<ul>
<li>距离也称 <em>跳数</em>，每经过一个路由器 跳数 加一。到直连网络的跳数为 1
<ul>
<li>最多允许 15 跳，超过 15 则网络不可达
<ul>
<li>防止数据报陷入环路</li>
</ul>
</li>
<li>优先选择跳数少的路径</li>
</ul>
</li>
<li>路由表项目：&lt;目的网络 N, 距离 d, 下一跳路由器地址 X&gt;</li>
<li><strong>距离向量算法</strong>，过程如下，
<ul>
<li>对于从相邻路由器发来的 RIP 路由更新信息，将其 下一跳 字段改为 相邻路由器的地址，将其 距离 字段的值增加 1</li>
<li>然后对比原来的路由表，增添缺少的、替换更优的</li>
<li>如果超时（默认 180 秒）后仍未收到某相邻路由器的更新路由表，将此路由器标记为不可达，即将距离设置为 16</li>
</ul>
</li>
</ul>
</li>
<li>RIP 动态建立并维护 路由表，默认每隔 30 秒就向相邻路由器广播一次 RIP 路由更新信息
<ul>
<li>最终所有路由器都拥有整个 IP 网络的路由表（称为 RIP 最终是收敛的）</li>
</ul>
</li>
<li>RIP 不支持 子网掩码，每个网络的 子网掩码 必须相同
<ul>
<li>在 RIP2 中修复了这个缺点</li>
</ul>
</li>
<li>特点，
<ul>
<li>仅和相邻路由器交换信息
<ul>
<li>交换的信息是当前路由器所知道的全部信息，即完整的路由表</li>
</ul>
</li>
<li>按固定的时间间隔交换路由信息，如间隔 30 秒</li>
</ul>
</li>
<li>优点，
<ul>
<li>简单、开销小、收敛快</li>
</ul>
</li>
<li>缺点，
<ul>
<li>最多 15 跳，限制了网络的规模</li>
<li>交换的路由更新信息包含完整的路由表，网络规模越大开销越大</li>
<li>网络出现故障时 需要较长时间才能向所有路由器更新该消息，称为 慢收敛现象
<ul>
<li>“坏消息传得慢”：不可达消息不能直接被传达，刚开始只能让相邻路由器换一个路由</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>RIP 是应用层协议，使用 UDP 传送数据。RIP 选择的路径不一定用时最短，但一定途径路由器最少。</p>
<p><strong>开放最短路径优先 OSPF</strong>，Open Shortest Path First，路由器间频繁交换链路状态信息。</p>
<ul>
<li>各路由器都有一个 反映全网拓扑的 链路状态数据库
<ul>
<li>该数据库全网一致（链路状态数据库的同步）</li>
<li>链路状态带有 32bit 的序号 表示其新旧程度。越大越新</li>
<li>根据该数据库 使用 Dijkstra 算法构造路由表
<ul>
<li>实际中路由表不会存储完整路径，只存储 下一跳</li>
</ul>
</li>
</ul>
</li>
<li>每当链路状态发生变化，路由器使用 洪泛法 交换并更新链路信息
<ul>
<li>只发送与该路由器相邻的链路的信息，不像 RIP 发送整个路由表</li>
<li>收敛快，不会出现 RIP 慢收敛的问题</li>
<li>为了让全网数据库保持一致，也会规定相隔固定时间（例如 30min）就刷新一次数据库</li>
</ul>
</li>
<li>为了适用于超大规模网络，OSPF 可将一个自治系统划分为<strong>区域</strong>
<ul>
<li>区域内部的路由器只知道本区域的完整网络拓扑</li>
<li>区域支持分层。处在上层的区域称为 <em>主干区域</em>，负责连通下层各区域、连接其它自治域</li>
</ul>
</li>
<li>OSPF 定义了 5 种分组：
<ul>
<li>问候分组，用于 确定 相邻站点的可达性
<ul>
<li>通常每隔 10 秒 两个相邻路由器就交换一次问候分组</li>
</ul>
</li>
<li>数据库描述分组，向邻站分享自己 链路状态数据库 的摘要信息</li>
<li>链路状态请求分组，请求获得某链路的详细信息</li>
<li>链路状态更新分组，即洪泛法更新路由信息</li>
<li>链路状态确认分组，对 链路状态更新分组 进行确认</li>
</ul>
</li>
<li>特点，
<ul>
<li>链路代价的度量 可根据 IP 分组的不同服务类型 TOS 被设置为不同形式
<ul>
<li>十分灵活，OSPF 对不同类型的业务 可算出合适的不同路由</li>
</ul>
</li>
<li>支持多路径间的负载平衡，可将通信量分配给 多条代价相同的路径</li>
<li>拥有鉴别功能，保证了仅在可信赖的路由器之间交换链路状态信息</li>
<li>支持子网掩码（可变长度的子网划分）和无分类编址 CIDR</li>
</ul>
</li>
</ul>
<p>OSPF 使用 IP 数据报传送数据。</p>
<h4 id="外部网关协议bgp"><a class="markdownIt-Anchor" href="#外部网关协议bgp"></a> 外部网关协议（BGP）</h4>
<p><strong>边界网关协议 BGP</strong>，Border Gateway Protocol，用于不同自治系统的路由器之间交换信息。</p>
<ul>
<li>自治系统之间，很难做到最佳路由的选择。BGP 力求寻找一条相对较好的路由</li>
<li>BGP 是应用层协议，基于 TCP</li>
<li>工作方式，
<ul>
<li>每个自治系统由管理员选择 至少一个路由器作为 <strong>BGP 发言人</strong>，各个自治系统的 BGP 发言人之间建立 TCP 连接，在此连接上交换 BGP 报文以建立 BGP 会话，通过会话交换路由信息
<ul>
<li>交换的路由信息很简洁，只会讲明 “途径某些路由器可以到达某网络”，即路径序列</li>
<li>各 BGP 发言人 就能以此获知网络可达性的信息，然后找出到各自治系统的较好路由</li>
</ul>
</li>
<li>维护一张路由表，每项记录了 目的网络、下一跳路由器、途径的自治系统序列
<ul>
<li>BGP 支持 CIDR，所以 目的网络 是用 CIDR 地址记录的网络前缀</li>
</ul>
</li>
<li>在 BGP 刚运行时，BGP 的邻站交换整个 BGP 路由表，以后只在发生变化时更新变化的部分</li>
</ul>
</li>
<li>BGP-4 使用的 4 种报文：
<ul>
<li>打开报文，Open，与相邻的另一个 BGP 发言人建立关系</li>
<li>更新报文，Update，送出 某一路由的信息、被撤销的路由条目</li>
<li>保活报文，Keepalive，响应 打开报文 并周期性地证实邻站关系
<ul>
<li>OSPF 中与之类似的分组是 Hello 分组</li>
</ul>
</li>
<li>通知报文，Notification，通知检测到的差错</li>
</ul>
</li>
</ul>
<h4 id="rip-ospf-bgp-的对比"><a class="markdownIt-Anchor" href="#rip-ospf-bgp-的对比"></a> RIP、OSPF、BGP 的对比</h4>
<p>RIP, Routing Information Protocol<br />
OSPF, Open Shortest Path First<br />
BGP, Border Gateway Protocol</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">RIP</th>
<th style="text-align:center">OSPF</th>
<th style="text-align:center">BGP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">适用范围</td>
<td style="text-align:center">自治系统内部</td>
<td style="text-align:center">自治系统内部</td>
<td style="text-align:center">自治系统之间</td>
</tr>
<tr>
<td style="text-align:center">路由算法</td>
<td style="text-align:center">距离-向量 算法</td>
<td style="text-align:center">链路状态</td>
<td style="text-align:center">路径-向量 算法</td>
</tr>
<tr>
<td style="text-align:center">传递协议</td>
<td style="text-align:center">UDP</td>
<td style="text-align:center">IP 数据报</td>
<td style="text-align:center">TCP</td>
</tr>
<tr>
<td style="text-align:center">路由选择</td>
<td style="text-align:center">跳数最少优先</td>
<td style="text-align:center">代价最低优先</td>
<td style="text-align:center">寻找相对较好的路由</td>
</tr>
<tr>
<td style="text-align:center">交换对象</td>
<td style="text-align:center">相邻路由器。最终收敛</td>
<td style="text-align:center">所有路由器（洪泛法）</td>
<td style="text-align:center">相邻发言人</td>
</tr>
<tr>
<td style="text-align:center">交换内容</td>
<td style="text-align:center">所有已知信息，即路由表</td>
<td style="text-align:center">相邻的链路状态</td>
<td style="text-align:center">整个路由表 / 有变化的部分</td>
</tr>
</tbody>
</table>
<h3 id="46-ip-组播"><a class="markdownIt-Anchor" href="#46-ip-组播"></a> 4.6 IP 组播</h3>
<p>组播 / 多播，比起 广播 向网络所有主机发送数据报，它是给特定的一组主机发送数据。</p>
<ul>
<li>组播只应用于 UDP。而 TCP 是面向连接的协议，只能针对两个进程间的一对一通信
<ul>
<li>组播数据报不提供可靠交付</li>
</ul>
</li>
<li>组播由路由器支持实现。能进行组播的路由器称为 组播路由器</li>
<li>主机使用 因特网组管理协议 IGMP 来加入组播组
<ul>
<li>体现为主机通知本地网络上的路由器</li>
</ul>
</li>
<li>注意事项，
<ul>
<li>组播数据报不产生 ICMP 差错报文</li>
</ul>
</li>
</ul>
<p>IP 组播地址，每个 D 类地址标志一个组播组。范围在 <code>224.0.0.0</code> ~ <code>239.255.255.255</code>。</p>
<p><strong>因特网组管理协议 IGMP</strong>，Internet Group Management Protocol，使路由器知道组播组成员的信息。</p>
<ul>
<li>工作过程，
<ul>
<li>主机要加入某个组播组，会向组播组的组播地址发送一个 IGMP 报文，声明要成为该组成员</li>
<li>组播路由器收到 IGMP 报文后，将组成员关系 转发给其它组播路由器</li>
<li>之后，组播路由器会周期性探寻 本地局域网的组播组是否活跃
<ul>
<li>若没有任何一台主机响应，则不再将该组的成员关系转发给其它组播路由器</li>
</ul>
</li>
</ul>
</li>
<li>组播路由的选择，找出以源主机（发信端）为根的 <em>组播转发树</em>
<ul>
<li>树的分支上的路由器 不会重复收到组播数据报（即没有环路）</li>
<li>同一个多播组，对不同的源点也会有不同的多播转发树</li>
<li>三种路由算法：
<ul>
<li>基于链路状态的路由选择（回忆 OSPF）</li>
<li>基于距离-向量的路由选择（回忆 RIP）</li>
<li>协议无关的组播 PIM</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="47-移动-ip"><a class="markdownIt-Anchor" href="#47-移动-ip"></a> 4.7 移动 IP</h3>
<p><strong>移动 IP</strong>，移动结点能以固定的 IP 地址跨越网段（漫游），且基于 IP 地址的网络权限在漫游过程中不发生任何改变。</p>
<ul>
<li>基于 IPv4 的移动 IP，有三种功能实体：
<ul>
<li>移动结点，指具有永久 IP 地址的移动结点</li>
<li>本地代理 / 归属代理，在归属网络中 对移动结点施行管理的实体，转交结点的数据报
<ul>
<li><strong>归属网络</strong>，移动结点的永久 IP 地址所在的网络</li>
<li>这样想，本地代理是移动设备接入互联网的入口</li>
</ul>
</li>
<li>外部代理 / 外地代理，在外部网络中 帮助移动结点完成移动管理功能的实体
<ul>
<li>这样想，外部代理帮助本地代理找到 移动设备位置</li>
</ul>
</li>
</ul>
</li>
<li>移动 IP 通信过程，核心在 <strong>永久地址 / 主地址</strong> 和 <strong>转交地址 / 辅地址</strong>，
<ul>
<li>移动结点在本地网时，按传统的 TCP/IP 方式通信</li>
<li>移动结点漫游到一个外地网络时，
<ul>
<li>移动结点向 外部代理 注册一个 <em>转交地址</em>，然后 外部代理 向 本地代理 登记 <em>转交地址</em></li>
<li>此时，若有发给结点的数据报，会由 本地代理 截取，转发给外部代理后，发给结点
<ul>
<li>截取的数据报会被重新封装，发给外部代理后，外部代理会拆封数据报</li>
</ul>
</li>
<li>此时，若结点有发出的数据报，会使用自己的永久地址（归属网络的地址）直接发送</li>
</ul>
</li>
<li>移动结点从外地网络回到归属网络时，转交地址被撤销，回到 TCP/IP 通信</li>
</ul>
</li>
</ul>
<h3 id="48-网络层设备域-路由器"><a class="markdownIt-Anchor" href="#48-网络层设备域-路由器"></a> 4.8 网络层设备（域、路由器）</h3>
<p>冲突域与广播域：</p>
<ul>
<li>冲突域上的所有工作站连接在同一根导线上，即同属于一个网段
<ul>
<li>属于物理层</li>
</ul>
</li>
<li>广播域是指所有能收到 <em>广播信息</em>（无视交换机等的过滤）的结点的集合，可以跨网段
<ul>
<li>属于数据链路层</li>
</ul>
</li>
</ul>
<p>数据链路层设备（网桥、交换机）不能隔离广播域，但可以隔离冲突域；<br />
路由器可划分广播域，通常 局域网 LAN 特指路由器分割出的广播域。</p>
<p><strong>路由器</strong>，连接不同网络 并完成路由转发的设备。多个逻辑网络（广播域）的互联必须使用路由器。</p>
<ul>
<li>路由器是网络层设备
<ul>
<li>路由器只能根据 IP 地址进行转发，不能使用 MAC 地址</li>
<li>额外：如果一个存储转发设备实现了某层功能，那它就可以互联该层次上不同协议的网段
<ul>
<li>路由器 是存储转发设备，它可以互联网络层上使用不同协议的网络</li>
<li>网桥 作为物理层的设备，不能进行存储转发，所以不能互联两个物理层不同的网段</li>
</ul>
</li>
<li>路由器实现了 物理层、数据链路层、网络层，可以从这些层面解析数据报</li>
</ul>
</li>
<li>数据报传输 与 路由器，
<ul>
<li>直接交付：发送数据报的源主机与目标主机在同一网络上，可直接交付 无需通过路由器</li>
<li>间接交付：路由器根据转发表（路由表）将数据报转发给下一个路由器</li>
</ul>
</li>
</ul>
<h2 id="第5章-传输层"><a class="markdownIt-Anchor" href="#第5章-传输层"></a> 第5章 传输层</h2>
<h3 id="51-传输层提供的服务"><a class="markdownIt-Anchor" href="#51-传输层提供的服务"></a> 5.1 传输层提供的服务</h3>
<p>传输层，为不同主机的进程之间提供通信。端到端的逻辑通信。</p>
<ul>
<li>逻辑通信，逻辑上存在（实际不存在）的物理连接</li>
<li>传输层要对整个报文进行差错检测
<ul>
<li>网络层只检查 IP 数据报的首部</li>
</ul>
</li>
<li>提供两种传输协议：面向连接的 TCP、无连接的 UDP
<ul>
<li>网络层不能同时实现这两种方式
<ul>
<li>二选一：面向连接的服务（虚电路）、无连接服务（数据报）</li>
</ul>
</li>
<li>网络层提供无连接服务 不影响传输层采用 TCP</li>
</ul>
</li>
</ul>
<p>传输层的<strong>端口</strong>，应用层的进程可将其数据通过端口交付给传输层。</p>
<ul>
<li>类似于 IP 地址在网络层的作用，端口 标识了主机中的应用程序
<ul>
<li>又可以说 网络层的 SAP 是 IP 地址、传输层的 SAP 是端口</li>
</ul>
</li>
<li><strong>端口号</strong>，16bit，标识本计算机应用层的各进程
<ul>
<li>只具有本地意义（不同计算机的相同端口号没有联系）</li>
<li>根据端口号范围，分为两类：
<ul>
<li>服务器端使用的端口，
<ul>
<li>熟知端口号，0 ~ 1023，<strong>互联网地址指派机构 IANA</strong> 把这些端口号指派给了 TCP/IP 最重要的一些应用程序，是早就被预定的
<ul>
<li>常用的熟知端口号：FTP 21、TELNET 23、SMTP 25、DNS 53、TFTP 69、HTTP 80、SNMP 161</li>
</ul>
</li>
<li>登记端口号，1024 ~ 49151，提供给没有熟知端口号的应用程序
<ul>
<li>使用这类端口号必须先在 IANA 登记，以防止重复</li>
</ul>
</li>
</ul>
</li>
<li>客户端使用的端口号，又称 短暂端口号 / 临时端口号，随着客户进程 而动态选择与释放
<ul>
<li>49152 ~ 65535</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><strong>套接字</strong>，Socket，IP 地址与端口号相组合。形如 <code>127.0.0.1:4000</code>
<ul>
<li>唯一地标识网络中的一个应用进程</li>
<li>这也说明，两个套接字形成的 TCP 连接是唯一的，不能再建立相同连接</li>
</ul>
</li>
</ul>
<p>关于 TCP 和 UDP，</p>
<ul>
<li>TCP/IP 协议族在 IP 层上使用了两个传输协议，即 TCP 和 UDP</li>
<li>TCP 提供一条全双工的可靠逻辑信道，UDP 提供一条不可靠的逻辑信道</li>
<li>TCP 面向连接，需要连接的建立与释放，用于 FTP、超文本传输协议 HTTP、SMTP 等
<ul>
<li>有 确认、流量控制、拥塞控制 等机制。其中 确认机制 保证了可靠性</li>
</ul>
</li>
<li>UDP 无连接，仅在 IP 层之上提供额外的两个服务：复用和分用、对数据的错误检查</li>
</ul>
<h3 id="52-udp-协议"><a class="markdownIt-Anchor" href="#52-udp-协议"></a> 5.2 UDP 协议</h3>
<p>UDP 在 IP 层之上仅提供了额外的两个服务：复用和分用、差错检测。</p>
<ul>
<li>复用，发送方使用同一个传输协议发送不同进程的数据</li>
<li>分用，接收方将收到的数据分发给不同进程</li>
</ul>
<p>UDP 的特点，</p>
<ul>
<li>不保证可靠交付，维护可靠性的工作<strong>在应用层完成</strong></li>
</ul>
<p>UDP 的优点，</p>
<ul>
<li>无需建立连接，延迟低</li>
<li>无需维护连接状态，使用 UDP 的服务器一般可支持更多的客户机
<ul>
<li>UDP 不仅支持一对一通信，还支持 一对多、多对一、多对多</li>
</ul>
</li>
<li>分组首部仅 8B，相比之下 TCP 首部长度为 20B</li>
<li>应用层通过 UDP 可更好控制要发送的数据和发送时间。没有拥塞控制，不受拥塞控制影响</li>
</ul>
<p>UDP 数据报，</p>
<ul>
<li>包含两个部分：首部、用户数据，
<ul>
<li><strong>首部，8B</strong>，由 4 个 等长 字段组成。各字段如下，
<ul>
<li>源端口，指明源端口号，在需要对方回信时使用。不需要回信就置为全 0</li>
<li>目的端口，指明目的端口号</li>
<li>长度，UDP 数据报的总长度，以 字节 为单位。最小值为 8，即不含数据段</li>
<li>校验和，校验整个数据报。源主机不想计算校验和 可置为全 0
<ul>
<li>不像 IP 数据报只校验首部</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>UDP 校验，计算校验和，</p>
<ul>
<li>
<p>计算之前先在 UDP 数据报前面增加 12B 的<strong>伪首部</strong>，计算完毕就会去除</p>
<ul>
<li>
<p>伪首部包含的内容，</p>
<table>
<thead>
<tr>
<th style="text-align:center">源 IP 地址</th>
<th style="text-align:center">目的 IP 地址</th>
<th style="text-align:center">0</th>
<th style="text-align:center">17</th>
<th style="text-align:center">UDP 长度</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">4B</td>
<td style="text-align:center">4B</td>
<td style="text-align:center">1B</td>
<td style="text-align:center">1B</td>
<td style="text-align:center">2B</td>
</tr>
</tbody>
</table>
</li>
</ul>
</li>
<li>
<p>计算时，先用 0 填充校验和字段，然后将 UDP 数据报切分为若干 16bit 子串（不足则用 0 补足）</p>
<ul>
<li>按二进制反码计算出这些 16 位字的和（反码相加 且最高位进位加到最低位上）</li>
<li>得到的结果的原码即是 校验和字段</li>
</ul>
</li>
<li>
<p>接收方收到的 UDP 数据报，加上 伪首部 并也进行 16bit 拆分的二进制反码加法</p>
<ul>
<li>结果的原码为全 1 则说明无差错，否则有差错、须丢弃该数据报</li>
</ul>
</li>
</ul>
<h3 id="53-tcp-协议"><a class="markdownIt-Anchor" href="#53-tcp-协议"></a> 5.3 TCP 协议</h3>
<p>TCP 是在不可靠的 IP 层上实现的可靠的数据传输协议。</p>
<p>TCP 的特点，</p>
<ul>
<li>面向连接。TCP 连接是一条逻辑连接，只能有两个端点
<ul>
<li>不像 UDP 支持多对多</li>
</ul>
</li>
<li>TCP 提供可靠交付的服务，保证传送的数据 无差错、不丢失、不重复、有序</li>
<li>TCP 提供全双工通信，为此 TCP 连接的两端都设有缓存
<ul>
<li>缓存存放的数据：准备发送的、已发送但未收到确认的、不按序到达的、尚未被程序读取的</li>
</ul>
</li>
<li>TCP 是面向字节流的，程序送来的的数据被视为无结构的字节流</li>
</ul>
<p>TCP 报文段，既可以 运载数据 又可以 建立连接、释放连接、应答。</p>
<ul>
<li>TCP 报文的长度由 接收方给出的窗口值、当前网络拥塞程度决定
<ul>
<li>而 UDP 报文的长度完全由发送应用进程决定</li>
</ul>
</li>
<li>一个 TCP 报文段分为两部分：首部、数据
<ul>
<li><strong>首部，最短为 20B</strong>，长度应为 4B 整倍数。其前 20B 有固定含义，
<ul>
<li>源端口、目的端口，各 2B</li>
<li>序号，4B，对传送的每个字节按顺序编号
<ul>
<li>例如有个报文携带的数据共有 100B，则下一报文的序号要增加 100</li>
<li>序号标注的是数据的第一个字节</li>
<li>每个连接的序号不重合。建立连接时初始序号各都不同</li>
</ul>
</li>
<li>确认号，4B，为 N 就表示 N-1 为止的序号的数据都正确收到，期望收到序号 N 的数据</li>
<li>数据偏移 / 首部长度，4bit，指出数据段的起始位置距离报文起始处有多远
<ul>
<li>这与 IP 数据报分片的数据偏移不同</li>
<li>以 4B 为单位，则 TCP 首部最长为 60B</li>
</ul>
</li>
<li>保留，6bit。目前设为 0</li>
<li>紧急位 URG、<strong>确认位 ACK</strong>、推送位 PSH、<strong>同步位 SYN</strong>、<strong>终止位 FIN</strong>
<ul>
<li>ACK=1 表示这是 确认报文段</li>
<li>SYN=1 表示这是 连接请求报文段</li>
<li>FIN=1 表示这是 连接释放报文段</li>
</ul>
</li>
<li>窗口，2B，从确认号开始 还允许对方发送的数据量</li>
<li>校验和，2B，校验整个 TCP 数据报
<ul>
<li>计算与 UDP 一样，要加上 12B 的伪首部（只需协议字段改为 6，其余都一样）</li>
</ul>
</li>
<li>紧急指针，2B，指出本报文段的紧急数据共有多少字节。仅在 URG=1 时有意义
<ul>
<li>紧急数据放在数据段最前面</li>
</ul>
</li>
<li>选项，长度可变</li>
<li>填充，使得整个首部长度是 4B 的整倍数</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>TCP 的连接管理</strong>（连接的建立、释放），</p>
<ul>
<li>因为面向连接，所以有三个阶段：连接建立、数据传送、连接释放
<ul>
<li>TCP 连接管理就是保证 连接建立 和 连接释放 的正确进行</li>
</ul>
</li>
<li>TCP 连接的建立（三次握手），
<ul>
<li>客户机的 TCP 向服务器的 TCP 发送连接请求报文段
<ul>
<li>SYN=1</li>
<li>选择一个初始序号 seq=x</li>
<li>该报文段不携带数据，但要消耗一个序号</li>
</ul>
</li>
<li>服务器 B 发回确认
<ul>
<li>ACK=1</li>
<li>确认号为 ack=x+1，选择一个初始序号 seq=y</li>
<li>该报文段不携带数据，但要消耗一个序号</li>
<li>此时完成了服务端的资源分配。这样的机制使得服务器易受到 SYN 洪泛攻击</li>
</ul>
</li>
<li>主机 A 的 TCP 向服务器 B 确认，ACK=1
<ul>
<li>确认号为 ack=y+1</li>
<li>该报文段可携带数据。若不携带数据则不会消耗序号</li>
</ul>
</li>
</ul>
</li>
<li>TCP 连接的释放（四次握手），
<ul>
<li>客户机发出连接释放 TCP
<ul>
<li>FIN=1，本方不再发送数据。对方仍可发送</li>
<li>序号 seq=u，等于上次传去数据的最后一个序号 加 1</li>
<li>客户进程进入 FIN-WAIT-1 状态</li>
<li>不携带数据，但消耗一个序号</li>
</ul>
</li>
<li>服务器发出确认
<ul>
<li>确认号 ack=u+1。序号为 seq=v，等于上次传过去数据的最后一个序号 加 1</li>
<li>服务器进入 CLOSE-WAIT 状态</li>
<li>此时从客户机到服务器的连接被完全释放，但服务器到客户的连接未关闭</li>
</ul>
</li>
<li>若服务器已经没有要向客户机发送的数据，就发出 连接释放 TCP
<ul>
<li>FIN=1</li>
<li>序号为 seq=w，等于上次传过去数据的最后一个序号 加 1；ack=u+1，重复上一次</li>
<li>服务器进入 LAST-ACK 状态</li>
</ul>
</li>
<li>客户机发出确认
<ul>
<li>ACK=1</li>
<li>确认号 ack=w+1，序号 seq=u+1</li>
<li>等待计时器设置的 最长报文段寿命 2MSL 后，TCP 连接被完全释放
<ul>
<li>客户机先进入 TIME-WAIT 状态，等待完毕才会进入 CLOSED 状态</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>总结：
<ul>
<li>连接建立，
<ul>
<li>SYN=1, seq=x</li>
<li>SYN=1, ACK=1, seq=y, ack=x+1</li>
<li>ACK=1, seq=x+1, ack=y+1</li>
</ul>
</li>
<li>连接释放，
<ul>
<li>FIN=1, seq=u</li>
<li>ACK=1, seq=v, ack=u+1</li>
<li>FIN=1, ACK=1, seq=w, ack=u+1</li>
<li>ACK=1, seq=u+1, ack=w+1</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>TCP 可靠传输</strong>，通过以下手段保证，</p>
<ul>
<li>校验机制，与 UDP 的校验一样</li>
<li>序号，建立在字节流上。即编号的单位为 字节</li>
<li>确认。TCP 默认使用累计确认，即可以一次确认多个报文段
<ul>
<li>注意，是针对报文段进行确认。但序号是针对字节的</li>
<li>与后退 N 帧 GBN 不同，TCP 会缓存失序的报文。对于确实需要重传的帧，TCP 另有办法</li>
</ul>
</li>
<li><strong>重传</strong>，主要针对 超时、冗余
<ul>
<li>超时，TCP 会动态计算报文段的 <strong>往返时间 RTT</strong>，得出 RTT 的加权平均 RTT_s，超时重传时间略大于 RTT_s</li>
<li>冗余，发送方连续收到三个重复的 ACK 报文（冗余 ACK）时，就认为该 ACK 确认的报文段之后的报文段已经丢失，需要重传
<ul>
<li>这种技术被称为 <em>快速重传</em></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>TCP 流量控制</strong>，避免发送速率太快使接收方缓存区溢出。可以说是一个速度匹配服务。</p>
<ul>
<li>TCP 的流量控制基于 滑动窗口协议
<ul>
<li>接收方根据自己的接收缓存大小，动态设置 <strong>接收窗口 rwnd</strong>（Receiving Window）
<ul>
<li>接收方使用确认报文段首部的 窗口字段 向发送方通知自己的 <em>接收窗口 rwnd</em></li>
</ul>
</li>
<li>发送方根据当前网络拥塞程度的估计值，确定 <strong>拥塞窗口 cwnd</strong>（Congestion Window）</li>
<li><strong>发送方的实际发送窗口上限，取 min{ rwnd, cwnd }</strong></li>
<li>发送方可一次发送的最大数据流，决定于接收方的接收窗口
<ul>
<li>要将确认序号纳入考虑，即考虑到已发出的数据会占用接收方的窗口，只是没收到确认</li>
</ul>
</li>
</ul>
</li>
<li>与 数据链路层 的流量控制的区别，
<ul>
<li>数据链路层定义两个相邻结点的流量控制，传输层定义端到端进程之间的流量控制</li>
<li>数据链路层的滑动窗口不能动态变化，传输层的则可以动态变化</li>
</ul>
</li>
</ul>
<p><strong>TCP 拥塞控制</strong>，确保网络能承载所达到的流量，防止拥塞。</p>
<ul>
<li>对端点来说，拥塞往往表现为通信时延的增加</li>
<li>比起流量控制，拥塞控制是一个全局性的过程，涉及到所有的主机、路由器，以及相关因素</li>
<li>TCP 拥塞控制 本质上是调整发送方的 <em>拥塞窗口 cwnd</em>。除非接收窗口更小</li>
<li>几种拥塞控制算法，
<ul>
<li>慢开始和拥塞避免，
<ul>
<li><strong>慢开始算法</strong>，在 TCP 连接刚建立时 cwnd=1，每收到一个确认 cwnd 加 1（指数增大）
<ul>
<li><em><strong>最大报文段长度 MSS</strong></em>，TCP 报文的最大长度
<ul>
<li>这里 cwnd 的单位就是 1 个 MSS</li>
</ul>
</li>
<li>指数增加：第一次传送 1 个报文段，第二次 2 个报文段，第三次 4 个报文段 ……</li>
<li>当该次会增加到 cwnd &gt; ssthresh 时，令 cwnd = ssthresh，换为拥塞避免算法</li>
</ul>
</li>
<li><strong>拥塞避免算法</strong>，每经过一个往返时延 RTT 就将发送方的 cwnd 加 1（线性增大）
<ul>
<li>比起慢开始算法的指数增加，拥塞避免算法是线性增长</li>
</ul>
</li>
<li>规定一个 <strong>开始门限 / 阈值 ssthresh</strong>
<ul>
<li>cwnd &lt; ssthresh 时，使用 慢开始算法</li>
<li>cwnd ≥ ssthresh 时，使用 拥塞避免算法</li>
</ul>
</li>
<li>当网络出现拥塞时（未按时收到确认），就将 ssthresh 降到 cwnd 的一半，并 cwnd=1</li>
</ul>
</li>
<li>快重传和快恢复
<ul>
<li>快重传，使用冗余 ACK 检测丢包的发生。发送方连续收到三个重复的 ACK 报文（冗余 ACK）时，直接重传丢失报文段，不必等待重传计时器超时</li>
<li>快恢复，快速重传后（连续收到三个冗余 ACK），设置 ssthresh = cwnd = cwnd/2</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr />
<p>慢开始和拥塞避免</p>
<p><img src="images/%E6%85%A2%E5%BC%80%E5%A7%8B%E5%92%8C%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D.jpg" alt="慢开始和拥塞避免" /></p>
<hr />
<p>快重传和快恢复</p>
<p><img src="images/%E5%BF%AB%E9%87%8D%E4%BC%A0%E5%92%8C%E5%BF%AB%E6%81%A2%E5%A4%8D.jpg" alt="快重传和快恢复" /></p>
<hr />
<h2 id="第6章-应用层"><a class="markdownIt-Anchor" href="#第6章-应用层"></a> 第6章 应用层</h2>
<h3 id="61-应用模型客户服务器-p2p"><a class="markdownIt-Anchor" href="#61-应用模型客户服务器-p2p"></a> 6.1 应用模型（客户/服务器、P2P）</h3>
<p><strong>客户/服务器模型</strong>，Client/Server，C/S，由一台服务器 和许多客户机构成。</p>
<ul>
<li>工作流程，就是客户机发出服务请求，服务器分析并处理后发回结果</li>
<li>主要特点，
<ul>
<li>服务器可对客户机进行权限管理，网络中各计算机的地位不平等</li>
<li>客户机之间不直接通信</li>
<li>可扩展性不强，服务器支持的客户机数量有限</li>
</ul>
</li>
<li>常见的使用 客户/服务器模型的应用包括：web（浏览器）、FTP、电子邮件、远程登陆</li>
</ul>
<p><strong>P2P 模型</strong>，去中心化，每个结点都具有下载、上传的功能。</p>
<ul>
<li><strong>对等方</strong>，模型上的任意一对计算机。可相互直接通信</li>
<li>但会使互联网压力很大，各大 互联网服务提供商 ISP 通常对 P2P 持反对态度</li>
</ul>
<h3 id="62-域名系统-dns"><a class="markdownIt-Anchor" href="#62-域名系统-dns"></a> 6.2 域名系统 DNS</h3>
<p><strong>域名系统 DNS</strong>，Domain Name System，将主机名 <code>www.xxx.com</code> 转换为 IP 地址。</p>
<ul>
<li>采用 客户/服务器 模型，其协议运行在 UDP 之上，使用 53 号端口</li>
</ul>
<p><strong>域名</strong> Domain Name，具有层次结构，</p>
<ul>
<li>顶级域名 TLD，Top Level Domain，<code>www.xxxx.com</code> 的 <code>com</code> 部分
<ul>
<li>可分为 国家/地区顶级域名、通用顶级域名、基础结构域名/反向域名</li>
</ul>
</li>
<li>二级域名，<code>www.xxxx.com</code> 的 <code>xxxx</code> 部分
<ul>
<li>若是 <code>www.yyyy.xxxx.com</code> 的形式，<code>yyyy</code> 也是二级域名。此时的域名解析 需要查询两个顶级域名服务器</li>
</ul>
</li>
<li>三级域名，<code>www.xxxx.com</code> 的 <code>www</code> 部分</li>
</ul>
<p>域名与 IP 地址不是一对一的关系。IP 地址与域名可以多对多。</p>
<p><strong>域名服务器</strong>，完成域名到 IP 地址的解析，</p>
<ul>
<li><strong>区</strong>，一个域名服务器所管辖的范围（不以 域 为单位）</li>
<li>域名服务器以层次方式组织</li>
<li>主要有 4 种域名服务器，
<ul>
<li><strong>根域名服务器</strong>，是最高层次的域名服务器，存有所有 顶级域名服务器 的 IP 地址
<ul>
<li>即用于管辖 顶级域名（如 <code>.com</code>）</li>
<li>告诉本地域名服务器下一步应向哪个 顶级域名服务器 查询</li>
<li>全球有 13 个</li>
</ul>
</li>
<li><strong>顶级域名服务器</strong>，存有所注册的所有二级域名
<ul>
<li>查询结果可能是目标结果，也可能是下一步的域名服务器的 IP 地址</li>
<li>很多时候，权限域名服务器 和 本地域名服务器 是同一个</li>
</ul>
</li>
<li><strong>授权域名服务器 / 权限域名服务器</strong>，将主机名转换为 IP 地址</li>
<li><strong>本地域名服务器</strong>，用户所使用的域名服务器
<ul>
<li>通常一个 ISP、一所大学就可以有一个本地域名服务器</li>
<li>若本地域名服务器无法解析，就会求助于根域名服务器</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>域名解析过程</strong>，域名与 IP 地址的相互映射。</p>
<ul>
<li><em>正向映射</em>，域名映射为 IP 地址；<em>反向解析</em>，IP 地址映射为域名</li>
<li>当客户端需要域名解析时，构造一个 DNS 请求报文，以 UDP 数据报的方式发往本地域名服务器</li>
<li>域名解析有两种方式：递归查询、递归与迭代相结合的查询
<ul>
<li>递归查询，本地域名服务器只需向根域名服务器查询一次
<ul>
<li>会对根域名服务器造成过大负载，实际中几乎不使用</li>
</ul>
</li>
<li>递归与迭代结合的查询，主机使用递归查询、本地域名服务器使用迭代查询
<ul>
<li>迭代查询 是指依次查询 根域名服务器、顶级域名服务器、权限域名服务器</li>
<li>在主机看来依然是递归查询，只需查询一次</li>
</ul>
</li>
</ul>
</li>
<li>为了提高 DNS 效率，域名服务器广泛地使用了高速缓存，可直接提前提供 IP 地址
<ul>
<li>主机名和 IP 地址之间的映射不是永久的，所以隔段时间需要丢弃缓存中的信息</li>
</ul>
</li>
</ul>
<p><img src="images/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F.jpg" alt="域名解析的两种方式" /></p>
<h3 id="63-文件传输协议-ftp"><a class="markdownIt-Anchor" href="#63-文件传输协议-ftp"></a> 6.3 文件传输协议 FTP</h3>
<p><strong>文件传输协议 FTP</strong>，File Transfer Protocol，一种文件传输协议，使用 TCP。</p>
<ul>
<li>提供不同类型主机系统之间的文件传输能力，无视硬件与软件的差异</li>
<li>提供交互式的访问，允许客户指明文件的类型与格式</li>
<li>允许文件具有权限</li>
<li>以匿名 FTP 的方式提供公用文件共享的能力。提供匿名用户，名为 anonymous，密码任意</li>
</ul>
<p>工作过程，</p>
<ul>
<li>打开熟知端口 21，等待客户进程的连接请求</li>
<li>主进程 负责接收新请求，若干从进程 负责处理单个请求</li>
</ul>
<p>FTP 的工作方式，使用两个并行的 TCP 连接，</p>
<ul>
<li>控制连接，端口号 21，用来传输控制信息，例如连接请求、传送请求
<ul>
<li>控制信息以 7 位 ASCII 格式发送</li>
<li>在整个会话期间已知保持打开状态</li>
</ul>
</li>
<li>数据连接，端口号 20，进行文件传送，传输完毕一次即关闭
<ul>
<li>服务端收到文件传输请求后，创建 数据传送进程 和 数据连接</li>
<li>数据连接有两种传输模式，
<ul>
<li>主动模式 PORT，服务器用 20 端口与客户端开放的某端口进行连接</li>
<li>被动模式 PASV，服务器随机开放一个端口并告知客户端，客户端进行连接</li>
</ul>
</li>
</ul>
</li>
<li>因为使用单独的连接进行控制传输，所以说 FTP 的<strong>控制信息是 外带传送的</strong>。</li>
</ul>
<p>若 FTP 要修改服务器上的文件，必须先把它下载下来，再上传回去。</p>
<ul>
<li>网络文件系统 NFS 改善了这一问题。它允许进程打开一个远程文件，进行远程读写</li>
</ul>
<h3 id="64-电子邮件smtp-mine-pop"><a class="markdownIt-Anchor" href="#64-电子邮件smtp-mine-pop"></a> 6.4 电子邮件（SMTP、MINE、POP）</h3>
<p>电子邮件系统，基于 TCP，由三部分组成：</p>
<ul>
<li>用户代理 UA，User Agent，用户与电子邮件系统的接口，体现为 PC 上的客户端程序</li>
<li>邮件服务器，采用 C/S 方式工作，对邮件进行收发，反馈邮件传送情况
<ul>
<li>当邮件服务器 A 向 B 发邮件时，A 为客户；反之，A 为服务器</li>
</ul>
</li>
<li>邮件发送协议和读取协议，分为邮件发送协议 和邮件读取协议
<ul>
<li>邮件发送协议，SMTP，使用 “推”（Push）的通信方式</li>
<li>邮件读取协议，POP3，使用 “拉”（Pull）的通信方式</li>
</ul>
</li>
</ul>
<p><img src="images/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E7%B3%BB%E7%BB%9F.jpg" alt="电子邮件系统" /></p>
<p>电子邮件格式，</p>
<ul>
<li>电子邮件地址，形如 <code>abc@xxxx.com</code>。邮箱名、邮箱所在主机的域名</li>
<li>典型的邮件内容，首部 与 主体 之间用空行进行分隔，<figure class="highlight md"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">From:aaaa@xxxx.com</span><br><span class="line">To:bbbb@yyy.com</span><br><span class="line">Subject:Say hello to Internet     // 主题。可选</span><br><span class="line"></span><br><span class="line">[主体]</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>多用途网际邮件扩充 MIME</strong>，Multipurpose Internet Mail Extensions，支持更多语言文字。</p>
<ul>
<li>针对 SMTP 只能传送一定长度 ASCII 码邮件的问题</li>
<li>对 SMTP 进行扩充，主要包括的内容：
<ul>
<li>5 个新的邮件首部字段，包括 MIME 版本、内容描述、内容标识、传送编码、内容类型</li>
<li>定义了许多邮件内容的格式，支持多媒体电子邮件、对其表示方法进行了标准化</li>
<li>定义了传送码，可对任何内容格式进行转换，而不会被邮件系统改变</li>
</ul>
</li>
</ul>
<p><strong>简单邮件传输协议 SMTP</strong>，Simple Mail Transfer Protocol，TCP 连接，端口号 25<br />
。</p>
<ul>
<li>SMTP 通信有三个阶段，
<ul>
<li>连接建立。SMTP 客户端 周期性扫描邮件缓存，若发现有邮件，就使用 25 端口与 接收方邮件服务器 建立 TCP 连接</li>
<li>邮件传送</li>
<li>连接释放</li>
</ul>
</li>
</ul>
<p><strong>邮局协议 POP3</strong>，Post Office Protocol，TCP 连接，端口号 110，用户拉取邮箱中的邮件。</p>
<ul>
<li>功能有限，甚至不能加密发送的密码</li>
<li>下载并保留：用户下载邮件后服务器端保留副本；下载并删除：服务器端不保留副本</li>
<li><strong>因特网报文存取协议 IMAP</strong>，另一种邮件读取协议，比 POP 复杂得多</li>
</ul>
<h3 id="65-万维网-www"><a class="markdownIt-Anchor" href="#65-万维网-www"></a> 6.5 万维网 WWW</h3>
<p><strong>万维网 WWW</strong>，World Wide Web，由三个部分组成，</p>
<ul>
<li><strong>统一资源定位符 RUL</strong>，每个文档在整个万维网内具有唯一的 URL
<ul>
<li><code>&lt;协议&gt;://&lt;主机&gt;:&lt;端口&gt;/&lt;路径&gt;</code>，例如 <code>https://hidolen.github.io/考研/计算机网络</code></li>
<li>URL 不区分大小写</li>
</ul>
</li>
<li><strong>超文本传输协议 HTTP</strong>，应用层协议，默认端口号 80，使用 TCP 进行可靠传输
<ul>
<li>HTTP 本身是无连接的（交换 HTTP 报文不需要事先建立 HTTP 连接）</li>
<li>HTTP 是无状态的，服务器对任意一次请求的响应一致
<ul>
<li>服务器可以响应一个唯一识别码 Cookie，用户接下来的访问可在请求报文加上 Cookie</li>
</ul>
</li>
<li>HTTP 有两类报文，
<ul>
<li>请求报文，客户端发出服务请求</li>
<li>响应报文，服务器响应请求</li>
</ul>
</li>
<li>HTTP 可选择两种连接方式，
<ul>
<li>非持久连接，网页的每个元素对象都要单独建立一个 TCP 连接进行传输
<ul>
<li>HTTP/1.0 仅支持非持久连接</li>
</ul>
</li>
<li>持久连接，服务器在发送响应后保持连接，可以继续在连接上传输后续的报文
<ul>
<li>非流水线方式，客户收到响应后才能发出下一个请求</li>
<li>流水线方式，不等响应 立即发送请求</li>
</ul>
</li>
</ul>
</li>
<li>HTTP 的报文
<ul>
<li>HTTP 是面向文本的，报文中的每个字段都是 ASCII 码串</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>HTTP 请求报文 中常用的几个方法，</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>请求读取 URL 资源</td>
</tr>
<tr>
<td>HEAD</td>
<td>与 GET 类似，但只获取资源的元信息</td>
</tr>
<tr>
<td>POST</td>
<td>提交表单、上传文件</td>
</tr>
<tr>
<td>CONNECT</td>
<td>用于代理服务器</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>超文本标记语言 HTML</strong>，使用约定的标记 对页面上的内容进行描述</li>
</ul>
<h3 id="常见应用层协议"><a class="markdownIt-Anchor" href="#常见应用层协议"></a> 常见应用层协议</h3>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">FTP 数据连接</th>
<th style="text-align:center">FTP 控制连接</th>
<th style="text-align:center">TELNET</th>
<th style="text-align:center">SMTP</th>
<th style="text-align:center">DNS</th>
<th style="text-align:center">TFTP</th>
<th style="text-align:center">HTTP</th>
<th style="text-align:center">POP3</th>
<th style="text-align:center">SNMP</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">协议</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">UDP</td>
<td style="text-align:center">UDP</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">TCP</td>
<td style="text-align:center">UDP</td>
</tr>
<tr>
<td style="text-align:center">端口</td>
<td style="text-align:center">20</td>
<td style="text-align:center">21</td>
<td style="text-align:center">23</td>
<td style="text-align:center">25</td>
<td style="text-align:center">53</td>
<td style="text-align:center">69</td>
<td style="text-align:center">80</td>
<td style="text-align:center">110</td>
<td style="text-align:center">161</td>
</tr>
</tbody>
</table>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">HiDolen</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/[object%20Object]/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">http://example.com/[object%20Object]/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">时间·线</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/">课堂笔记</a><a class="post-meta__tags" href="/tags/%E8%80%83%E7%A0%94/">考研</a><a class="post-meta__tags" href="/tags/408/">408</a></div><div class="post_share"><div class="social-share" data-image="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机组成原理</div></div></a></div><div class="next-post pull-right"><a href="/%5Bobject%20Object%5D/hello-world/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Hello World</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/" title="操作系统"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">操作系统</div></div></a></div><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">数据结构</div></div></a></div><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="计算机组成原理"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">计算机组成原理</div></div></a></div><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/%E6%95%B0%E5%AD%A6/%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/" title="概率论与数理统计"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">概率论与数理统计</div></div></a></div><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/%E6%95%B0%E5%AD%A6/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" title="线性代数"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">线性代数</div></div></a></div><div><a href="/%5Bobject%20Object%5D/%E8%AF%BE%E5%A0%82%E7%AC%94%E8%AE%B0/%E8%80%83%E7%A0%94/%E6%95%B0%E5%AD%A6/%E9%AB%98%E6%95%B0/%E4%B8%80%E4%BA%9B%E5%85%AC%E5%BC%8F/" title="一些公式"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-08</div><div class="title">一些公式</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">HiDolen</div><div class="author-info__description">HiDolen 的个人博客。平时写的笔记都在这里</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">110</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">45</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">46</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC1%E7%AB%A0-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text"> 第1章 计算机网络体系结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0"><span class="toc-number">1.1.</span> <span class="toc-text"> 1.1 计算机网络概述</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84%E4%B8%8E%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text"> 1.2 计算机网络体系结构与参考模型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#osi-%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B-tcpip-%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text"> OSI 参考模型、TCP&#x2F;IP 模型</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC2%E7%AB%A0-%E7%89%A9%E7%90%86%E5%B1%82"><span class="toc-number">2.</span> <span class="toc-text"> 第2章 物理层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#21-%E9%80%9A%E4%BF%A1%E5%9F%BA%E7%A1%80%E5%9F%BA%E7%A1%80%E6%A6%82%E5%BF%B5"><span class="toc-number">2.1.</span> <span class="toc-text"> 2.1 通信基础（基础概念）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A5%88%E5%A5%8E%E6%96%AF%E7%89%B9%E5%AE%9A%E7%90%86-%E9%A6%99%E5%86%9C%E5%AE%9A%E7%90%86"><span class="toc-number">2.1.1.</span> <span class="toc-text"> 奈奎斯特定理、香农定理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E7%A0%81-%E8%B0%83%E5%88%B6"><span class="toc-number">2.1.2.</span> <span class="toc-text"> 编码、调制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%94%B5%E8%B7%AF%E4%BA%A4%E6%8D%A2-%E6%8A%A5%E6%96%87%E4%BA%A4%E6%8D%A2-%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2"><span class="toc-number">2.1.3.</span> <span class="toc-text"> 电路交换、报文交换、分组交换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E7%BB%84%E4%BA%A4%E6%8D%A2%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8A%A5-%E8%99%9A%E7%94%B5%E8%B7%AF"><span class="toc-number">2.1.4.</span> <span class="toc-text"> 分组交换的：数据报、虚电路</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22-%E4%BC%A0%E8%BE%93%E4%BB%8B%E8%B4%A8"><span class="toc-number">2.2.</span> <span class="toc-text"> 2.2 传输介质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23-%E7%89%A9%E7%90%86%E5%B1%82%E8%AE%BE%E5%A4%87%E4%B8%AD%E7%BB%A7%E5%99%A8-%E9%9B%86%E7%BA%BF%E5%99%A8"><span class="toc-number">2.3.</span> <span class="toc-text"> 2.3 物理层设备（中继器、集线器）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC3%E7%AB%A0-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82"><span class="toc-number">3.</span> <span class="toc-text"> 第3章 数据链路层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#31-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">3.1.</span> <span class="toc-text"> 3.1 数据链路层的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32-%E7%BB%84%E5%B8%A7"><span class="toc-number">3.2.</span> <span class="toc-text"> 3.2 组帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33-%E5%B7%AE%E9%94%99%E6%8E%A7%E5%88%B6"><span class="toc-number">3.3.</span> <span class="toc-text"> 3.3 差错控制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34-%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6-%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93%E6%9C%BA%E5%88%B6"><span class="toc-number">3.4.</span> <span class="toc-text"> 3.4 流量控制、可靠传输机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35-%E4%BB%8B%E8%B4%A8%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6mac"><span class="toc-number">3.5.</span> <span class="toc-text"> 3.5 介质访问控制（MAC）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36-%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">3.6.</span> <span class="toc-text"> 3.6 局域网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%A5%E5%A4%AA%E7%BD%91-%E4%B8%8E-ieee-8023"><span class="toc-number">3.6.1.</span> <span class="toc-text"> 以太网 与 IEEE 802.3</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ieee-80211-%E6%97%A0%E7%BA%BF%E5%B1%80%E5%9F%9F%E7%BD%91"><span class="toc-number">3.6.2.</span> <span class="toc-text"> IEEE 802.11 无线局域网</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#vlan%E8%99%9A%E6%8B%9F%E5%B1%80%E5%9F%9F%E7%BD%91-virtual-lan"><span class="toc-number">3.6.3.</span> <span class="toc-text"> VLAN，虚拟局域网 Virtual LAN</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37-%E5%B9%BF%E5%9F%9F%E7%BD%91"><span class="toc-number">3.7.</span> <span class="toc-text"> 3.7 广域网</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ppp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">3.7.1.</span> <span class="toc-text"> PPP 协议</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#hdlc-%E5%8D%8F%E8%AE%AE%E7%95%A5"><span class="toc-number">3.7.2.</span> <span class="toc-text"> HDLC 协议（略）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E8%AE%BE%E5%A4%87"><span class="toc-number">3.8.</span> <span class="toc-text"> 3.8 数据链路层设备</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC4%E7%AB%A0-%E7%BD%91%E7%BB%9C%E5%B1%82"><span class="toc-number">4.</span> <span class="toc-text"> 第4章 网络层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#41-%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">4.1.</span> <span class="toc-text"> 4.1 网络层的功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42-%E8%B7%AF%E7%94%B1%E7%AE%97%E6%B3%95"><span class="toc-number">4.2.</span> <span class="toc-text"> 4.2 路由算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43-ipv4"><span class="toc-number">4.3.</span> <span class="toc-text"> 4.3 IPv4</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-%E5%88%86%E7%BB%84-ip-%E6%95%B0%E6%8D%AE%E6%8A%A5"><span class="toc-number">4.3.1.</span> <span class="toc-text"> IP 分组 &#x2F; IP 数据报</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ip-%E5%9C%B0%E5%9D%80-nat"><span class="toc-number">4.3.2.</span> <span class="toc-text"> IP 地址、NAT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86-%E6%8E%A9%E7%A0%81-cidr"><span class="toc-number">4.3.3.</span> <span class="toc-text"> 子网划分、掩码、CIDR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1-ip-%E5%9C%B0%E5%9D%80%E4%B8%8E%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80-mac"><span class="toc-number">4.3.4.</span> <span class="toc-text"> 路由、IP 地址与物理地址 MAC</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#arp-dhcp-icmp"><span class="toc-number">4.3.5.</span> <span class="toc-text"> ARP、DHCP、ICMP</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44-ipv6"><span class="toc-number">4.4.</span> <span class="toc-text"> 4.4 IPv6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45-%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AE%E8%87%AA%E6%B2%BB%E7%B3%BB%E7%BB%9F"><span class="toc-number">4.5.</span> <span class="toc-text"> 4.5 路由协议（自治系统）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AErip-ospf"><span class="toc-number">4.5.1.</span> <span class="toc-text"> 内部网关协议（RIP、OSPF）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEbgp"><span class="toc-number">4.5.2.</span> <span class="toc-text"> 外部网关协议（BGP）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#rip-ospf-bgp-%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-number">4.5.3.</span> <span class="toc-text"> RIP、OSPF、BGP 的对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46-ip-%E7%BB%84%E6%92%AD"><span class="toc-number">4.6.</span> <span class="toc-text"> 4.6 IP 组播</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47-%E7%A7%BB%E5%8A%A8-ip"><span class="toc-number">4.7.</span> <span class="toc-text"> 4.7 移动 IP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48-%E7%BD%91%E7%BB%9C%E5%B1%82%E8%AE%BE%E5%A4%87%E5%9F%9F-%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">4.8.</span> <span class="toc-text"> 4.8 网络层设备（域、路由器）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC5%E7%AB%A0-%E4%BC%A0%E8%BE%93%E5%B1%82"><span class="toc-number">5.</span> <span class="toc-text"> 第5章 传输层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#51-%E4%BC%A0%E8%BE%93%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.1.</span> <span class="toc-text"> 5.1 传输层提供的服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#52-udp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.2.</span> <span class="toc-text"> 5.2 UDP 协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53-tcp-%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.3.</span> <span class="toc-text"> 5.3 TCP 协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC6%E7%AB%A0-%E5%BA%94%E7%94%A8%E5%B1%82"><span class="toc-number">6.</span> <span class="toc-text"> 第6章 应用层</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#61-%E5%BA%94%E7%94%A8%E6%A8%A1%E5%9E%8B%E5%AE%A2%E6%88%B7%E6%9C%8D%E5%8A%A1%E5%99%A8-p2p"><span class="toc-number">6.1.</span> <span class="toc-text"> 6.1 应用模型（客户&#x2F;服务器、P2P）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#62-%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F-dns"><span class="toc-number">6.2.</span> <span class="toc-text"> 6.2 域名系统 DNS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#63-%E6%96%87%E4%BB%B6%E4%BC%A0%E8%BE%93%E5%8D%8F%E8%AE%AE-ftp"><span class="toc-number">6.3.</span> <span class="toc-text"> 6.3 文件传输协议 FTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#64-%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6smtp-mine-pop"><span class="toc-number">6.4.</span> <span class="toc-text"> 6.4 电子邮件（SMTP、MINE、POP）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#65-%E4%B8%87%E7%BB%B4%E7%BD%91-www"><span class="toc-number">6.5.</span> <span class="toc-text"> 6.5 万维网 WWW</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">6.6.</span> <span class="toc-text"> 常见应用层协议</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 By HiDolen</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>